
@{
    ViewBag.Title = "purchase";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<link href="~/assets/js/plugin/datetimepicker/jquery.datetimepicker.css" rel="stylesheet" />

<script>$(document).ready(function () {

        $('#IndexVentas').addClass("nav-item active submenu");

        $.fn.dataTable.moment("DD/MM/YYYY");

        $('#tabla01').DataTable({
            "searching": true,
            "paging": true,
            "language": {
                "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json"
            },
            "scrollX": true,
            info: true,
        });
    });

    $(document).ready(function () {


        $('.input-number').on('input', function () {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        $('.input-number-fecha').on('input', function () {
            this.value = this.value.replace(/[^0-9/]/g, '');
        });

        $('input[type="text"]').each(function () {
            if ($(this).val() != "") {
                empty = false;
                return false;
            }
        });

        $("#formulario1").validate();

    });</script>

<style type="text/css">
    .wizard {
        background: #ffffff;
        padding: 30px;
        box-shadow: 2px 6px 15px 0px rgb(69 65 78 / 10%);
    }

        .wizard .nav-tabs {
            position: relative;
            border: 0px;
        }

        .wizard > div.wizard-inner {
            position: relative;
        }

    .connecting-line {
        height: 15px;
        background: #e0e0e0;
        position: absolute;
        width: 99.5%;
        margin: 0 auto;
        left: 0;
        right: 0;
        top: 44%;
        z-index: 1;
        border-radius: 15px;
    }

    .active-line {
        height: 15px;
        background: #e0e0e0;
        position: absolute;
        width: 99.5%;
        margin: 0 auto;
        left: 0;
        right: 0;
        top: 44%;
        z-index: 1;
        border-radius: 15px !important;
    }

    .active .connecting-line {
        background-color: #ed1d24;
        box-shadow: 4px 4px 10px rgb(69 65 78 / 71%);
    }

    .border-right {
        border-radius: 15px 0 0 15px;
    }

    .border-left {
        border-radius: 0;
    }

    .wizard .nav-tabs > li.active > a, .wizard .nav-tabs > li.active > a:hover, .wizard .nav-tabs > li.active > a:focus {
        cursor: default;
        border: 0;
        color: #d0191f;
        border-bottom-color: transparent;
        box-shadow: 4px 4px 10px rgb(69 65 78 / 71%);
    }

    .nav-tabs li p {
        padding-top: 70px;
        font-size: 14px;
        text-align: center;
    }

    .list-inline {
        text-align: center;
    }

    span.round-tab {
        width: 70px;
        height: 70px;
        line-height: 70px;
        display: inline-block;
        border-radius: 100px;
        background: #DFE3E4;
        border: 2px solid #fff;
        z-index: 1;
        position: absolute;
        text-align: center;
        font-size: 25px;
    }

    .wizard li.active span.round-tab {
        background: #ed1d24;
        color: white;
        border: 2px solid #fff;
    }

    span.round-tab:hover {
        color: white;
        border: 2px solid #fff;
        background-color: #ed1d24;
    }

    .wizard .nav-tabs > li {
        width: 25%;
    }

        .wizard .nav-tabs > li a {
            width: 70px;
            height: 70px;
            margin: 20px auto;
            border-radius: 100%;
            padding: 0;
            color: #777;
        }

    .wizard .tab-pane {
        position: relative;
        padding-top: 15px;
        border-top: 1px solid #fff;
        margin-top: 50px;
    }

    .next-step:hover, .next-step, .prev-step:hover, .prev-step {
        position: relative;
        background-color: #000000;
        font-size: 16px;
        color: #FFFFFF;
    }

    .nav > li {
        position: relative;
        display: block
    }

        .nav > li > a {
            position: relative;
            display: block;
            padding: 10px 15px
        }

    .table .thead-dark th {
        color: #fff;
        background-color: #000000;
        border-color: #32383e;
    }

    .btn-default {
        background: #000000 !important;
        color: #ffffff !important;
    }

    .select2-container--bootstrap .select2-selection {
        background-color: #ffffff;
        border: 1px solid #ebedf2;
        border-radius: 4px;
        color: inherit;
        font-size: 13px;
        outline: 0;
        line-height: 1.5 !important;
    }

    .select2-container--bootstrap .select2-search--dropdown .select2-search__field {
        background-color: #ffffff;
        border: 1px solid #ebedf2;
        border-radius: 4px;
        color: #555;
        font-size: 13px;
        padding: 4px 10px;
    }

    .select2-container--bootstrap .select2-results__option--highlighted[aria-selected] {
        background-color: #2a88ff;
        color: #ffffff;
    }

    .flexbox {
        align-items: center;
        display: flex;
        height: 120px;
        justify-content: center;
        width: 200px;
        background: #ffffff;
        color: #333;
    }

    table.dataTable thead tr {
        background-color: #1f1e2e;
        color: white
    }

    .header th {
        height: 25px;
        line-height: 2px;
    }

    table.dataTable thead tr {
        background-color: #000000;
        color: white;
        font-size: 12px;
    }

    table.dataTable tr {
        font-size: 13px;
    }

    .table td, .table th {
        /* font-size: 14px; */
        /* border-top-width: 0px; */
        /* border-bottom: 1px solid; */
        border-color: #ebedf2 !important;
        padding: 0 5px !important;
        height: 55px;
        /* vertical-align: middle !important; */
    }

    .btn-danger {
        background: #ed1d24 !important;
        border-color: #F25961 !important;
    }

    .list-inline > li {
        display: inline-block;
        padding-right: 5px;
        padding-left: 5px;
    }
</style>


<div class="page-inner">
    <div class="page-header">
        <h4 class="page-title">Ventas</h4>
        <ul class="breadcrumbs">
            <li class="nav-home">
                <a href="#">
                    <i class="flaticon-home"></i>
                </a>
            </li>
            <li class="separator">
                <i class="flaticon-right-arrow"></i>
            </li>
            <li class="nav-item">
                <a href="#">Venta </a>
            </li>
            <li class="separator">
                <i class="flaticon-right-arrow"></i>
            </li>
            <li class="nav-item">
                <a href="#">Nueva </a>
            </li>
        </ul>
    </div>


    <section>
        <div class="wizard">
            <div class="wizard-inner">
                <div class="active-line"></div>
                <ul class="nav nav-tabs" role="tablist">


                    <li role="presentation" class="active stepactive2">
                        <div class="connecting-line border-right border-left"></div>
                        <a href="#step2" data-toggle="tab" aria-controls="step2" role="tab">
                            <span class="round-tab">
                                1
                            </span>
                            <p>	Método de pago</p>
                        </a>
                    </li>

                    <li role="presentation" class="disabled stepactive1">
                        <div class="connecting-line border-right"></div>
                        <a href="#step1" data-toggle="tab" aria-controls="step1" role="tab">
                            <span class="round-tab">
                                2
                            </span>
                            <p>Agregar artículos</p>
                        </a>
                    </li>

                    <li role="presentation" class="disabled stepactive3">
                        <div class="connecting-line border-right border-left"></div>
                        <a href="#step3" data-toggle="tab" aria-controls="step3" role="tab">
                            <span class="round-tab">
                                3
                            </span>
                            <p>Método de envió </p>
                        </a>
                    </li>

                    <li role="presentation" class="disabled stepactive4">
                        <div class="connecting-line"></div>
                        <a href="#complete" data-toggle="tab" aria-controls="complete" role="tab">
                            <span class="round-tab">
                                4
                            </span>
                            <span><p style="width: 84px; text-align:center">Confirmación</p></span>

                        </a>
                    </li>

                </ul>
            </div>

            <form role="form">
                <div class="tab-content">


                    <div class="tab-pane active" role="tabpanel" id="step2">
                        <hr />
                        <h3>Método de pago</h3>
                        <div class="card-category">Información de venta  </div>
                        <div class="row">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Fecha de venta   </label>
                                    <input disabled type="date" class="form-control form-control" id="Fecha_Venta" onchange="ValidaInput('Fecha_Venta')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Vendedor  </label>
                                    <select disabled class="form-control form-control" id="Select_Vendedores" onchange="ValidaSelect('Select_Vendedores')">
                                        <option value="0">Seleccionar </option>
                                        @foreach (var item1 in CRMRetail.Datos.Catalogos.SeleccionarVendedores())
                                        {
                                            <option value="@item1.Id">@item1.Nombre</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Sucursal  </label>
                                    <select class="form-control form-control" id="Sucursal" onchange="ValidaSelect('Sucursal')">
                                        <option value="0">Seleccionar </option>
                                        @foreach (var item1 in ViewBag.Sucursales)
                                        {
                                            <option value="@item1.Id">@item1.Nombre</option>
                                        }

                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="defaultSelect">* Forma de pago  </label>
                                    <select class="form-control form-control" id="Select_FormaPago" onchange="ValidaSelect('Select_FormaPago')">
                                        <option value="0">Seleccionar </option>
                                        <option value="1">Efectivo  </option>
                                        <option value="2">Tarjeta  </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-6">
                                <div class="form-group" id="Div_Select_Bancos" style="display: none;">
                                    <label for="defaultSelect"> Tipo de tarjeta  </label>
                                    <select class="form-control form-control" id="Select_FormaPago_Tarjeta">
                                        <option value="0">Seleccionar </option>
                                        <option value="1">VISA  </option>
                                        <option value="2">Mastercard  </option>
                                        <option value="3">Amex – american express  </option>
                                        <option value="4">BBVA  </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <hr />
                        <div class="card-category" id="Card_Cliente_Title">Información de cliente   </div>
                        <div class="row" id="div_InfoCliente">

                            @*SELECT IMPORTANTE*@
                            <div class="col-md-12 col-lg-12">
                                <div class="form-group">
                                    <label for="largeInput">* Agregar cliente (buscar por nombre, apellidos o RFC):  </label>
                                    <div class="select2-input">
                                        <select id="basic" name="basic" onchange="ClienteDetalle(); Verificar(this.value);" class="form-control" style="width:100%">
                                            <option value="0">Seleccionar</option>
                                            @foreach (var item1 in ViewBag.Clientes)
                                            {
                                                <option value="@item1.Id">@item1.Nombre (@item1.RFC)</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            @*<div class="col-md-6 text-right">
                                    <a class="btn btn-default" id="Btn_NuevoCliente">
                                        <span class="btn-label">
                                            <i class="fa fa-user-plus"></i>
                                        </span>
                                        Agregar Nuevo Cliente
                                    </a>
                                    <input type="checkbox" name="NuevoCliente" id="NuevoCliente" value="0" style="display: none;">
                                </div>*@
                            <div class="col-md-4 col-lg-4" id="Div_FromCliente1" style="display: none;">
                                <div class="card-category">Información  </div>
                                <p>
                                    <strong>Nombre: </strong><span id="SC_Nombre"></span>
                                    <br />
                                    <strong>Persona: </strong><span id="SC_Persona"></span>
                                    <br />
                                    <strong><span id="SC_TitleFecha">Fecha:</span> </strong><span id="SC_Fecha"></span>
                                    <br />
                                    <strong>RFC: </strong><span id="SC_RFC"></span>
                                    <br />
                                    <strong><span id="SC_TitleSexo"></span> </strong><span id="SC_Sexo"></span>
                                    <br />
                                    <strong>Tipo de Cliente: </strong><span id="SC_TipoCliente"></span>
                                    <br />
                                    <strong>Origen: </strong><span id="SC_Origen"></span>
                                </p>
                            </div>
                            <div class="col-md-4 col-lg-4" id="Div_FromCliente2" style="display: none;">
                                <div class="card-category">Contacto </div>
                                <p>
                                    <strong>Correo electrónico : </strong><span id="SC_Correo"></span>
                                    <br />
                                    <strong>Teléfono móvil : </strong><span id="SC_Movil"></span>
                                    <br />
                                    <strong>Teléfono local : </strong><span id="SC_Local"></span>
                                    <br />
                                </p>
                            </div>
                            <div class="col-md-4 col-lg-4" id="Div_FromCliente3" style="display: none;">
                                <div class="card-category">Dirección  </div>
                                <p>
                                    <strong>Dirección fiscal: </strong><span id="SC_DireccionFisica"></span>
                                    <br />
                                    <strong>Dirección entrega : </strong><span id="SC_DireccionEntrega"></span>

                                </p>
                            </div>
                        </div>
                        <div class="card-title" id="Card_NuevoCliente_Title" style="display: none;">Agregar nuevo cliente</div>
                        <div class="card-category" id="Card_NuevoCliente_Categoria" style="display: none;">Completa los campos marcados *</div>
                        <div class="row" id="div_NuevoCliente" style="display: none;">
                            <div class="col-md-6 col-lg-6">
                            </div>
                            <div class="col-md-6 text-right">
                                <a class="btn btn-default" id="Btn_BuscarCliente">
                                    <span class="btn-label">
                                        <i class="fa fa-user-plus"></i>
                                    </span>
                                    Buscar Cliente
                                </a>
                            </div>
                        </div>
                        <div class="card-category" id="Card_NuevoCliente_Datos" style="display: none;">Datos </div>
                        <div class="row" id="row_TipoCliente" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Tipo de Cliente </label>
                                    <select class="form-control form-control" id="Select_Persona">
                                        <option value="0">Seleccionar </option>
                                        <option value="1">Persona Física </option>
                                        <option value="2">Persona Moral </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row" id="Fisica_Div1" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Nombre (s)</label>
                                    <input type="text" class="form-control form-control" id="Nombre" onchange="ValidaInput('Nombre')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Apellido Paterno </label>
                                    <input type="text" class="form-control form-control" id="Apellido_Paterno" onchange="ValidaInput('Apellido_Paterno')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput"> Apellido Materno </label>
                                    <input type="text" class="form-control form-control" id="Apellido_Materno">
                                </div>
                            </div>
                        </div>
                        <div class="row" id="Fisica_Div2" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Sexo </label>
                                    <select class="form-control form-control" id="Select_Sexo" onchange="ValidaSelect('Select_Sexo')">
                                        <option value="0">Seleccionar </option>
                                        <option value="1">Masculino  </option>
                                        <option value="2">Femenino  </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Fecha nacimiento  </label>
                                    <input type="date" class="form-control form-control" id="Fecha_Nacimiento" onchange="ValidaInput('Fecha_Nacimiento')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* RFC  </label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <button class="btn btn-default" type="button">Buscar</button>
                                        </div>
                                        <input type="text" class="form-control" onchange="ValidaRFC(this)" maxlength="13" autocomplete="off" placeholder="Ingrese su RFC" aria-label="" aria-describedby="basic-addon1" id="RFC" style="text-transform:uppercase">
                                    </div>
                                    <span style="color:#f44336" id="RFC_Mensaje"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="Moral_Div1" style="display: none;">
                            <div class="col-md-8 col-lg-8">
                                <div class="form-group">
                                    <label for="largeInput">* Nombre </label>
                                    <input type="text" class="form-control form-control" id="Nombre_Moral" onchange="ValidaInput('Nombre_Moral')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Fecha de constitución </label>
                                    <input type="date" class="form-control form-control" id="Fecha_Constitucion">
                                </div>
                            </div>
                        </div>
                        <div class="row" id="Moral_Div2" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* RFC  </label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <button class="btn btn-default" type="button">Buscar</button>
                                        </div>
                                        <input type="text" class="form-control" onchange="ValidaRFC(this)" placeholder="Ingrese su RFC" maxlength="12" autocomplete="off" aria-label="" aria-describedby="basic-addon1" id="RFC_Moral" style="text-transform:uppercase">
                                    </div>
                                    <span style="color:#f44336" id="RFC_MoralMensaje"></span>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <!-- Mensaje de busqueda por RFC -->
                            </div>
                        </div>

                        <hr id="hr_Separador" style="display: none;">
                        <div class="card-category" id="Card_NuevoCliente_Contacto" style="display: none;">Contacto </div>
                        <div class="row" id="row_Contacto" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Correo electrónico </label>
                                    <input type="text" class="form-control form-control" id="Correo_Electronico" onchange="ValidaInput('Correo_Electronico')">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">* Teléfono móvil </label>
                                    <input type="text" class="form-control form-control input-number" id="Telefono_Movil" maxlength="10" autocomplete="off" onchange="ValidaTelefono()">
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="largeInput">Teléfono local  </label>
                                    <input type="text" class="form-control form-control input-number" id="Telefono_Local" maxlength="10" autocomplete="off" onchange="ValidaTelefonoLocal()">
                                </div>
                            </div>
                        </div>

                        <div class="row" id="row_Contacto2" style="display: none;">
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Clasificación  </label>
                                    <select class="form-control form-control" id="Clasificacion" onchange="ValidaSelect('Clasificacion')">
                                        <option value="0">Seleccionar </option>
                                        @foreach (var item1 in CRMRetail.Datos.Catalogos.Seleccionar("TipoCliente"))
                                        {

                                            <option value="@item1.Id">@item1.Nombre</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-lg-4">
                                <div class="form-group">
                                    <label for="defaultSelect">* Origen de Cliente </label>
                                    <select class="form-control form-control" id="Origen_Cliente" onchange="ValidaSelect('Origen_Cliente')">
                                        <option value="0">Seleccionar </option>
                                        @foreach (var item2 in CRMRetail.Datos.Catalogos.Seleccionar("OrigenCliente"))
                                        {
                                            <option value="@item2.Id">@item2.Nombre</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            @*<div class="col-md-4 col-lg-4">
                                    <div class="form-group">
                                        <label for="defaultSelect">* Sucursal  </label>
                                        <select class="form-control form-control" id="Sucursal" onchange="ValidaSelect('Sucursal')">
                                            <option value="0">Seleccionar </option>
                                            @foreach (var item1 in ViewBag.Sucursales)
                                            {
                                                <option value="@item1.Id">@item1.Nombre</option>
                                            }

                                        </select>
                                    </div>
                                </div>*@
                        </div>
                        <hr />
                        <ul class="list-inline">
                            <li><button type="button" class="btn next-step" onclick="ValidarForm2()">Siguiente   <i class="fa fa-arrow-right"></i></button></li>
                        </ul>
                    </div>

                    <div class="tab-pane" role="tabpanel" id="step1">
                        <hr />
                        <h3>Agregar artículos</h3>
                        <div class="card-category">Artículos de venta  </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-7 col-lg-7">
                                        <div class="form-group">
                                            <label for="largeInput"> Agregar un producto (buscar por nombre, SKU):  </label>
                                            <div class="select2-input">
                                                <select id="basic2" name="basic2" onchange="ProductoDetalle(); Taller(this.value);" class="form-control" style="width:100%">
                                                    <option value="0">Seleccionar</option>
                                                    @foreach (var item1 in ViewBag.Productos)
                                                    {
                                                        <option value="@item1.Id">@item1.Nombre (@item1.SKU)</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-5 col-lg-5">
                                        <div class="form-group">
                                            <label for="largeInput"> Cantidad </label>
                                            <input type="number" class="form-control form-control" id="Cantidad">
                                        </div>
                                    </div>

                                </div>

                                <div class="row text-center">
                                    <div class="col-md-1 col-lg-1">
                                    </div>
                                    <a class="btn btn-danger col-md-4 col-lg-4" id="BtnRegistrarProducto" style="color:#ffffff">
                                        <span class="btn-label">
                                            <i class="fa fa-shopping-bag"></i>
                                        </span>
                                        Agregar
                                    </a>

                                    <div class="col-md-2 col-lg-2">
                                    </div>

                                    <div id="FechaTaller" class="col-md-4" style="display:none">
                                        <input id="fechatallersito" type="date" class="form-control form-control" />
                                    </div>
                                </div>

                                @*<h3>Ofertas disponibles</h3>
                                <p>Aplica las ofertas despues de agregar todos los productos y verifica los datos antes de realizar la compra.</p>*@
                                <div class="row text-center">
                                    <div id="OfertaDistribuidor" class="col-md-5 col-lg-5" style="display:none">
                                        <div class="form-group">
                                            <label for="largeInput">Precio Distribuidor</label>
                                            <br>
                                            <input type="checkbox" class="form-control form-control" id="AddSale" style="margin-left: auto; margin-right: auto;">

                                        </div>
                                    </div>
                                    @*<a onclick="GuardarTaller();" class="btn btn-danger col-md-4 col-lg-4"style="color:#ffffff">
                                       
                                        ConsultarTalleres
                                    </a>*@

                                    @*<div class="col-md-5 col-lg-5">
                                            <div class="form-group">
                                                <label for="largeInput">Ofertas X Producto</label>
                                                <br>
                                                <input type="checkbox" class="form-control form-control" id="AddSale" style="margin-left: auto; margin-right: auto;">

                                            </div>
                                        </div>*@
                                </div>


                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">Información de articulo.</div>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-7">
                                                <div class="card-category">Datos </div>
                                                <br />
                                                <p>
                                                    <strong>Nombre producto: </strong><span id="SP_Nombre"></span>
                                                    <br />
                                                    <strong>SKU: </strong><span id="SP_SKU"></span>
                                                    <br />
                                                    <strong>Categoría: </strong><span id="SP_Categoria"></span>
                                                    <br />
                                                    <strong>Descripción: </strong><span id="SP_Descripcion"></span>
                                                </p>
                                            </div>
                                            <div class="col-md-5">
                                                <div class="card-category">Imagen Artículo.</div>
                                                <br />
                                                <div id="DivImg">
                                                    <img src="~/assets/img/Weber-logo-F99FDDDEB3-seeklogo.com.png" class="d-block w-100" />
                                                </div>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr />

                        <table class="table table-striped" id="Table_Articulos">
                            <thead class="thead-dark text-center">
                                <tr>
                                    <th scope="col" width="20%">Producto SKU</th>
                                    <th scope="col" width="15%">Cantidad</th>
                                    <th scope="col" width="20%">Precio</th>
                                    <th scope="col" width="15%">P. Unitario</th>
                                    <th scope="col" width="10%">P. Total</th>
                                    <th scope="col" width="15%"></th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="4" class="text-right"><strong>Total</strong> </td>
                                    <td class="text-center"><strong id="resultado_total">$0.00</strong></td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                        <ul class="list-inline">
                            <li><button type="button" class="btn prev-step"><i class="fa fa-arrow-left"></i>  Anterior </button></li>
                            <li><button type="button" class="btn next-step" onclick="ValidarForm1()">Siguiente   <i class="fa fa-arrow-right"></i></button></li>
                        </ul>
                    </div>

                    <div class="tab-pane" role="tabpanel" id="step3">
                        <hr />
                        <h3>Método de envió</h3>
                        @*<div class="card-category">Actualiza la dirección fiscal o dirección de entrega. <br /><br /> </div>*@
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">Información de envío – entrega.</div>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6 col-lg-6">
                                                <div class="form-group">
                                                    <label for="defaultSelect">* Tipo de entrega  </label>
                                                    <select class="form-control form-control" id="Select_TipoEntrega" onchange="ValidaSelect('Select_TipoEntrega')">
                                                        <option value="0">Seleccionar </option>
                                                        <option value="1">Inmediata </option>
                                                        <option value="2">Programada </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="NuevaCargaDireccion" style="display: none;">


                                            <div class="row">
                                                <div class="col-md-4 col-lg-4">
                                                    <div class="form-group">
                                                        <label for="largeInput">* Fecha de Entrega  </label>
                                                        <input type="date" class="form-control form-control" id="Fecha_Entrega" onchange="ValidaInput('Fecha_Entrega')">
                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-lg-4">
                                                    <div class="form-group">
                                                        <label for="defaultSelect">* Horarios de entrega  </label>
                                                        <select class="form-control form-control" id="Select_Horarios" onchange="ValidaSelect('Select_Horarios')">
                                                            <option value="0">Seleccionar </option>
                                                            @foreach (var item1 in ViewBag.Horario)
                                                            {
                                                                <option value="@item1.Id">@item1.Nombre</option>
                                                            }
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-12">
                                                    <br /><br />
                                                    <div class="card-category" id="Categoria_Direcciones">Selecciona la dirección donde se realizará la entrega.</div>
                                                    <hr />
                                                </div>
                                            </div>
                                            <div class="row" id="View_List_DireccionesView_List_Direcciones" style="display: none;">
                                                <div class="col-md-12">
                                                    <div class="card full-height">
                                                        <div class="card-header">
                                                            <div class="card-head-row">
                                                                <div class="col-md-8">
                                                                    <div class="card-category">

                                                                        Da clic sobre
                                                                        <button type="button" class="btn btn-icon btn-default btn-round btn-xs">
                                                                            <i class="fa fa-times"></i>
                                                                        </button>, al seleccionar una dirección aparecerá marcada con el icono
                                                                        <button type="button" class="btn btn-icon btn-round btn-success btn-xs">
                                                                            <i class="fa fa-check"></i>
                                                                        </button>, si deseas agregar una nueva dirección, da clic en el botón agregar nueva dirección
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <input type="checkbox" name="NuevaDireccionFiscal" id="NuevaDireccionFiscal" value="0" style="display: none;">
                                                                    <a class="btn btn-default col-md-12" id="AgregarDirecciones">
                                                                        <span class="btn-label">
                                                                            <i class="fa fa-location-arrow"></i>
                                                                        </span>
                                                                        Agregar nueva dirección
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-body">
                                                            <div id="Direcciones_Seleccionar_List_IdCliente">

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" id="View_List_DireccionFiscal" style="display: none;">
                                                <div class="col-md-8">
                                                    <div class="card-title">Dirección fiscal registrada.</div>
                                                    <br /><br />
                                                </div>
                                                <div class="col-md-4">
                                                    <a class="btn btn-default col-md-12" id="AgregarDireccionFiscal">
                                                        <span class="btn-label">
                                                            <i class="fa fa-location-arrow"></i>
                                                        </span>
                                                        Agregar dirección fiscal
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="row" id="Agregar_DireccionFiscal" style="display: none;">
                                                <div class="col-md-8">
                                                    <div class="card-title">Dirección fiscal.</div>
                                                    <br /><br />
                                                </div>


                                            </div>
                                            <div class="row" id="Form_DireccionFiscal" style="display: none;">
                                                <div class="col-md-4 col-lg-4">
                                                    <div class="form-group">
                                                        <label for="defaultSelect">* Estado </label>
                                                        <select class="form-control form-control" id="Select_DEstado">
                                                            <option value="0">Seleccionar </option>

                                                            @foreach (var item1 in ViewBag.CatEstados)
                                                            {
                                                                <option value="@item1.Id">@item1.Nombre</option>
                                                            }

                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-lg-4" id="Busqueda_CP">
                                                    <div class="form-group">
                                                        <label for="largeInput"> Buscar por código postal   </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <button class="btn btn-default" type="button" id="BtnBuscar">Buscar</button>
                                                            </div>
                                                            <input type="text" class="form-control input-number" placeholder="" aria-label="" maxlength="5" aria-describedby="basic-addon1" id="CP_Fiscal">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-lg-4" id="Select_DivDelegacionMunicipio" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="defaultSelect">* Delegación / Municipio  </label>
                                                        <select class="form-control form-control" id="Select_Delegacion_Municipio">
                                                            <option value="0">Seleccionar </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-lg-4" id="Select_DivColonia" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="defaultSelect">* Colonia  </label>
                                                        <select class="form-control form-control" id="Select_Colonia">
                                                            <option value="0">Seleccionar </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-lg-4" id="Select_DivCP" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="defaultSelect">* CP  </label>
                                                        <select class="form-control form-control" id="Select_CP">
                                                            <option value="0">Seleccionar </option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col-md-4 col-lg-4" id="Select_DivCalle" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="largeInput">* Calle  </label>
                                                        <input type="text" class="form-control form-control" id="Calle" onchange="ValidaInput('Calle')">
                                                    </div>
                                                </div>

                                                <div class="col-md-2 col-lg-2" id="Select_DivNumExterior" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="largeInput">* Numero exterior  </label>
                                                        <input type="text" class="form-control input-number" id="NumeroExterior" onchange="ValidaInput('NumeroExterior')">
                                                    </div>
                                                </div>

                                                <div class="col-md-2 col-lg-2" id="Select_DivNumInterior" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="largeInput"> Numero interior  </label>
                                                        <input type="text" class="form-control input-number" id="NumeroInterior" onchange="ValidaInput('NumeroInterior')">
                                                    </div>
                                                </div>



                                                <div class="col-md-4 col-lg-4" id="Select_DivEntreCalles" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="largeInput"> Entre calles  </label>
                                                        <input type="text" class="form-control form-control" id="EntreCalles">
                                                    </div>
                                                </div>

                                                <div class="col-md-4 col-lg-4" id="Select_DivReferencias" style="display: none;">
                                                    <div class="form-group">
                                                        <label for="largeInput"> Referencias  </label>
                                                        <input type="text" class="form-control form-control" id="Referencias">
                                                    </div>
                                                </div>

                                                <div class="col-md-4 col-lg-4" id="Btn_DivBusqueda" style="display: none;">
                                                    <br /><br />
                                                    <a class="btn btn-link" id="BtnBuscarCP">
                                                        <span class="btn-label">
                                                            <i class="fa fa-search-plus"></i>
                                                        </span>
                                                        Nuevo CP
                                                    </a>
                                                </div>
                                            </div>


                                            <hr />
                                            <br />
                                            <div class="row" id="View_List_DireccionEntrega" style="display: none;">
                                                <div class="col-md-1">
                                                    <div class="card-title" id="Categoria_DireccionesEntrega">Direcciones de entrega registradas.</div>
                                                    <br /><br />
                                                </div>
                                                <div class="col-md-6" onclick="NewDireccion()">

                                                    @*NUEVA DIRECCIONNACEPTAR*@

                                                    <a class="btn btn-default col-md-12" id="Registro">
                                                        Confirmar nueva direccion
                                                    </a>

                                                    @*<input type="checkbox" name="NuevaDireccionEntrega" id="NuevaDireccionEntrega" value="0" style="display: none;">
                                                        <a class="btn btn-default col-md-12" id="AgregarDireccionEntrega">
                                                            <span class="btn-label">
                                                                <i class="fa fa-location-arrow"></i>
                                                            </span>
                                                            Agregar dirección de entrega
                                                        </a>*@
                                                </div>
                                                <div class="col-md-5">
                                                    <a class="btn btn-default col-md-12" id="SeleccionarDireccionFiscal">
                                                        Cancelar
                                                    </a>
                                                </div>
                                            </div>


                                            <div class="row" id="Agregar_DireccionEntrega" style="display: none;">
                                                <div class="col-md-8">
                                                    <div class="card-title">Dirección de entrega.</div>
                                                    <br /><br />
                                                </div>
                                                <div class="col-md-4">
                                                    <a class="btn btn-default col-md-12" id="SeleccionarDireccionEntrega">
                                                        <span class="btn-label">
                                                            <i class="fa fa-location-arrow"></i>
                                                        </span>
                                                        Seleccionar dirección entrega
                                                    </a>
                                                </div>
                                            </div>
                                            <div id="Form_DireccionEntrega" style="display: none;">
                                                <div class="row">
                                                    <div class="col-md-4 col-lg-4">
                                                        <div class="form-group">
                                                            <label for="defaultSelect">* Estado </label>
                                                            <select class="form-control form-control" id="Select_DEstado2">
                                                                <option value="0">Seleccionar </option>

                                                                @foreach (var item1 in ViewBag.CatEstados)
                                                                {
                                                                    <option value="@item1.Id">@item1.Nombre</option>
                                                                }

                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-lg-4" id="Busqueda_CP2">
                                                        <div class="form-group">
                                                            <label for="largeInput"> Buscar por código postal   </label>
                                                            <div class="input-group">
                                                                <div class="input-group-prepend">
                                                                    <button class="btn btn-default" type="button" id="BtnBuscar2">Buscar</button>
                                                                </div>
                                                                <input type="text" class="form-control input-number" placeholder="" aria-label="" maxlength="5" aria-describedby="basic-addon1" id="CP_Fiscal2">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-lg-4" id="Select_DivDelegacionMunicipio2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="defaultSelect">* Delegación / Municipio  </label>
                                                            <select class="form-control form-control" id="Select_Delegacion_Municipio2">
                                                                <option value="0">Seleccionar </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-lg-4" id="Select_DivColonia2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="defaultSelect">* Colonia  </label>
                                                            <select class="form-control form-control" id="Select_Colonia2">
                                                                <option value="0">Seleccionar </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-lg-4" id="Select_DivCP2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="defaultSelect">* CP  </label>
                                                            <select class="form-control form-control" id="Select_CP2">
                                                                <option value="0">Seleccionar </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4 col-lg-4" id="Select_DivCalle2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="largeInput">* Calle  </label>
                                                            <input type="text" class="form-control form-control" id="Calle2" onchange="ValidaInput('Calle2')">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-2 col-lg-2" id="Select_DivNumExterior2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="largeInput">* Numero exterior  </label>
                                                            <input type="text" class="form-control input-number" id="NumeroExterior2" onchange="ValidaInput('NumeroExterior2')">
                                                        </div>
                                                    </div>

                                                    <div class="col-md-2 col-lg-2" id="Select_DivNumInterior2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="largeInput"> Numero interior  </label>
                                                            <input type="text" class="form-control input-number" id="NumeroInterior2" onchange="ValidaInput('NumeroInterior2')">
                                                        </div>
                                                    </div>



                                                    <div class="col-md-4 col-lg-4" id="Select_DivEntreCalles2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="largeInput"> Entre calles  </label>
                                                            <input type="text" class="form-control form-control" id="EntreCalles2">
                                                        </div>
                                                    </div>

                                                    <div class="col-md-4 col-lg-4" id="Select_DivReferencias2" style="display: none;">
                                                        <div class="form-group">
                                                            <label for="largeInput"> Referencias  </label>
                                                            <input type="text" class="form-control form-control" id="Referencias2">
                                                        </div>
                                                    </div>

                                                    <div class="col-md-4 col-lg-4" id="Btn_DivBusqueda2" style="display: none;">
                                                        <br /><br />
                                                        <a class="btn btn-link" id="BtnBuscarCP2">
                                                            <span class="btn-label">
                                                                <i class="fa fa-search-plus"></i>
                                                            </span>
                                                            Nuevo CP
                                                        </a>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">Resumen de Compra.</div>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-category">Artículos  </div>
                                        <br />
                                        <table id="Table_ArticulosResumen" class="table table-striped">
                                            <thead class="thead-dark text-center">
                                                <tr>
                                                    <th scope="col">Producto SKU</th>
                                                    <th scope="col"> Cantidad</th>
                                                    <th scope="col">P. Total</th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td colspan="2" class="text-right"><strong>Total</strong> </td>
                                                    <td class="text-center"><strong id="resultado_total2">$0.00</strong></td>
                                                    <td class="text-center"></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                        <div class="card-category">Información del cliente   </div>
                                        <p>
                                            <strong>Nombre: </strong><span id="MV_Nombre"></span>
                                            <br />
                                            <strong>Persona: </strong><span id="MV_Persona"></span>
                                            <br />
                                            <strong><span id="MV_TitleFecha">Fecha:</span> </strong><span id="MV_Fecha"></span>
                                            <br />
                                            <strong>RFC: </strong><span id="MV_RFC"></span>
                                            <br />
                                            <strong><span id="MV_TitleSexo"></span> </strong><span id="MV_Sexo"></span>
                                            <br />
                                            <strong>Tipo de Cliente: </strong><span id="MV_TipoCliente"></span>
                                            <br />
                                            <strong>Origen: </strong><span id="MV_Origen"></span>
                                        </p>
                                        <div class="card-category">Contacto </div>
                                        <p>
                                            <strong>Correo electrónico : </strong><span id="MV_Correo"></span>
                                            <br />
                                            <strong>Teléfono móvil : </strong><span id="MV_Movil"></span>
                                            <br />
                                            <strong>Teléfono local : </strong><span id="MV_Local"></span>
                                            <br />
                                        </p>
                                        <div class="card-category">Método de pago   </div>
                                        <p>
                                            <strong>Forma de pago : </strong><span id="MV_Forma_Pago"></span>
                                            <br />
                                            <strong>Vendedor : </strong><span id="MV_Vendedor"></span>
                                            <br />
                                            <strong>Sucursal : </strong><span id="MV_Sucursal"></span>
                                            <br />
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ul class="list-inline">
                            <li><button type="button" class="btn prev-step"><i class="fa fa-arrow-left"></i>  Anterior</button></li>
                            <li><button type="button" class="btn btn-info-full next-step" onclick="ValidarForm3()">Siguiente <i class="fa fa-arrow-right"></i></button></li>
                        </ul>
                    </div>

                    <div class="tab-pane" role="tabpanel" id="complete">
                        <hr />
                        <h3>Confirmación</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">Resumen de Compra.</div>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-category">Dirección de entrega </div>
                                        <p>
                                            <strong>Dirección : </strong><span id="MV_Direccion"></span>
                                            <br />
                                        </p>
                                        <div class="card-category">Programada    </div>
                                        <p>
                                            <strong>Fecha y hora de entrega : </strong><span id="Fecha_Hora_Entrega"></span>
                                        </p>
                                        <div class="card-category">Información del cliente   </div>
                                        <p>
                                            <strong>Nombre: </strong><span id="MV_Nombre2"></span>
                                            <br />
                                            <strong>Persona: </strong><span id="MV_Persona2"></span>
                                            <br />
                                            <strong><span id="MV_TitleFecha2">Fecha:</span> </strong><span id="MV_Fecha2"></span>
                                            <br />
                                            <strong>RFC: </strong><span id="MV_RFC2"></span>
                                            <br />
                                            <strong><span id="MV_TitleSexo2"></span> </strong><span id="MV_Sexo2"></span>
                                            <br />
                                            <strong>Tipo de Cliente: </strong><span id="MV_TipoCliente2"></span>
                                            <br />
                                            <strong>Origen: </strong><span id="MV_Origen2"></span>
                                        </p>
                                        <div class="card-category">Contacto </div>
                                        <p>
                                            <strong>Correo electrónico : </strong><span id="MV_Correo2"></span>
                                            <br />
                                            <strong>Teléfono móvil : </strong><span id="MV_Movil2"></span>
                                            <br />
                                            <strong>Teléfono local : </strong><span id="MV_Local2"></span>
                                            <br />
                                        </p>
                                        <div class="card-category">Método de pago   </div>
                                        <p>
                                            <strong>Forma de pago : </strong><span id="MV_Forma_Pago2"></span>
                                            <br />
                                            <strong>Vendedor : </strong><span id="MV_Vendedor2"></span>
                                            <br />
                                            <strong>Sucursal : </strong><span id="MV_Sucursal2"></span>
                                            <br />
                                        </p>
                                        <div class="card-category">Artículos  </div>
                                        <br />
                                        <table id="Table_ArticulosResumen2" class="table table-striped">
                                            <thead class="thead-dark text-center">
                                                <tr>
                                                    <th scope="col">Producto SKU</th>
                                                    <th scope="col"> Cantidad</th>
                                                    <th scope="col">P. Total</th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td colspan="2" class="text-right"><strong>Total</strong> </td>
                                                    <td class="text-center"><strong id="resultado_total3">$0.00</strong></td>
                                                    <td class="text-center"></td>
                                                </tr>
                                            </tfoot>
                                        </table>


                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <div class="card-title">Confirmar venta .</div>
                                    </div>
                                    <div class="card-body">
                                        <div class="col-md-12">
                                            <a class="btn btn-default col-md-12" id="btnRegistrarVenta">
                                                <span class="btn-label">
                                                    <i class="fa fa-shopping-cart"></i>
                                                </span>
                                                Registrar
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ul class="list-inline">
                            <li><button type="button" class="btn prev-step"><i class="fa fa-arrow-left"></i>  Anterior</button></li>
                            @*<li><button type="button" class="btn btn-info-full next-step">Registrar venta </button></li>*@
                        </ul>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </form>
        </div>
    </section>


</div>

<script src="~/assets/js/plugin/select2/select2.full.min.js"></script>
<script src="../assets/js/plugin/datetimepicker/jquery.datetimepicker.full.js"></script>
<script src="~/assets/js/CRM.js"></script>

<script type="text/javascript">


    $(document).ready(function() {
        var vendedor = '@ViewBag.IdUser'; // Obtener el valor del ViewBag

        // Verificar si el valor del vendedor está presente en el select
        if ($('#Select_Vendedores option[value="' + vendedor + '"]').length) {
            $('#Select_Vendedores').val(vendedor); // Establecer el valor seleccionado
        } else {
            $('#Select_Vendedores').prop('disabled', false); // Habilitar el select
            $('#Select_Vendedores').val(0); // Establecer el valor predeterminado
        }
    });
    ////////////////////////////////////////////////////
    var talleres = [];
    ////////////////////////////////////////////////////

    function Taller(id)
    {
        var obj = {};
            obj['Id'] = (id);

            var jsonObject = {
                "data": obj
            };

            $.ajax({
            type: "POST",
            url: "@Url.Action("Taller", "Ventas")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
                success: function (data) {
                    if (data.Id == 28) {
                        $("#Cantidad").prop("disabled", true);
                        $("#Cantidad").val("1");
                        $("#FechaTaller").css("display", "block");
                    } else {
                        $("#Cantidad").prop("disabled", false);
                        $("#Cantidad").val("");
                        $("#FechaTaller").css("display", "none");
                    }
                },
                error: function (data) {

                }
            });

    }

    function Verificar(id)
    {
        var obj = {};
            obj['Id'] = (id);

            var jsonObject = {
                "data": obj
            };

            $.ajax({
            type: "POST",
            url: "@Url.Action("verificar", "Ventas")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
                success: function (data) {
                    if (data.IdCliente == 2) {
                        swal({
                            title: "Ofertas Disponibles",
                            text: "El cliente aplica para oferta de distribuidor",
                            icon: "success",
                            buttons: {
                                confirm: {
                                    className: 'btn btn-success'
                                }
                            },
                        })

                        //$("#OfertaDistribuidor").css("display", "block");

                    } else {

                        //$("#OfertaDistribuidor").css("display", "none");

                    }
                },
                error: function (data) {

                }
            });

    }
    $(document).ready(function () {
        $("#AddSale").change(function () {
            if ($(this).is(":checked")) {
                // Acciones si el checkbox está marcado
                $(".precio-selector").val(1).change();
            } else {
                // Acciones si el checkbox no está marcado
                $(".precio-selector").val(2).change();
            }
        });
    });

    function NewDireccion()
    {
        if (ValidarDirecciones()) {


            var obj = {};
            obj['IdCliente'] = $("#basic option:selected").val();
            obj['IdEstado'] = $("#Select_DEstado option:selected").val();
            obj['IdPoblacion'] = $("#Select_Delegacion_Municipio option:selected").val();
            obj['IdColonia'] = $("#Select_Colonia option:selected").val();
            obj['IdCP'] = $("#Select_CP option:selected").val();
            obj['Calle'] = $("#Calle").val();
            obj['NumExterior'] = $("#NumeroExterior").val();
            obj['NumInterior'] = $("#NumeroInterior").val();
            obj['EntreCalles'] = $("#EntreCalles").val();
            obj['Referencias'] = $("#Referencias").val();


            var jsonObject = {
                "data": obj
            };

            $.ajax({
            type: "POST",
            url: "@Url.Action("RNuevaDireccion", "Ventas")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
                success: function (data) {
                    $.notify({
                        message: "Dirección seleccionada"
                    }, {
                        type: 'success',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                },
                error: function (data) {
                    $.notify({
                        message: "Error en datos proporcionados."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                }
            });
        } else {
                $.notify({
                    message: "Dirección incompleta."
                }, {
                    type: 'danger',
                    allow_dismiss: false,
                    animate: {
                        enter: 'animated rollIn',
                        exit: 'animated rollOut'
                    }
                });
        }

    }

    $(document).ready(function () {
        $('#btnRegistrarVenta').click(function () {

            $("#btnRegistrarVenta").prop('disabled', true);


            var Ctalleres = sessionStorage.getItem('talleres');
            var talleres = JSON.parse(Ctalleres); 


            // METODO DE PAGO
            var MeotdoPago = false;
            if (ValidarPago()) {
                if ($('#NuevoCliente').prop('checked')) {
                    if (ValidarEmail()) {
                        if (ValidarTelefono()) {
                            if (ValidarTelefonoLocal()) {
                                if (ValidarFormualrioRFC()) {
                                    if (BusquedaRFC()) {
                                        MeotdoPago = true;
                                    }
                                }
                            }
                        }
                    }
                } else {
                    MeotdoPago = true;
                }
            } else {
                swal("Formulario incompleto !", "Completa el método de pago !", {
					icon : "warning",
					buttons: {
						confirm: {
							className : 'btn btn-warning'
						}
					},
				});
            }


            // ARTIUCLOS
            if (ValidarArticulos()) {
                // METODO DE PAGO
                if (MeotdoPago) {
                    if (ValidarDirecciones()) {

                        // CREAR OBJETO DE REGISTRO
                        var obj = {};

                        // ARTICULOS.

                        // METODO DE PAGO.
                        obj['FechaVenta'] = $('#Fecha_Venta').val();
                        obj['IdVendedor'] = $("#Select_Vendedores option:selected").val();
                        obj['IdSucursal'] = $("#Sucursal option:selected").val();
                        obj['IdFormaPago'] = $("#Select_FormaPago option:selected").val();
                        obj['IdFormaPagoTarjeta'] = $("#Select_FormaPago_Tarjeta option:selected").val();

                        // REGISTRO DE UN NUEVO CLIENTE
                        if ($('#NuevoCliente').prop('checked')) {
                            obj['NuevoCliente'] = 1;
                            // DATOS FORMULARO
                            var persona = $("#Select_Persona option:selected").val();
                            // CONTACTO
                            obj['Correo'] = $('#Correo_Electronico').val();
                            obj['TelefonoMovil'] = $('#Telefono_Movil').val();
                            obj['TelefonoLocal'] = $('#Telefono_Local').val();
                            obj['IdTipoCliente'] = $("#Clasificacion option:selected").val();
                            obj['IdOrigenCliente'] = $("#Origen_Cliente option:selected").val();

                            // PERSONA
                            obj['TipoPersona'] = persona;
                            if (persona == 1) {
                                // PERSONA FISICA
                                obj['Nombre'] = $('#Nombre').val();
                                obj['ApellidoPaterno'] = $('#Apellido_Paterno').val();
                                obj['ApellidoMaterno'] = $('#Apellido_Materno').val();
                                obj['Sexo'] = $("#Select_Sexo option:selected").val();
                                obj['FechaNacimiento'] = $('#Fecha_Nacimiento').val();
                                obj['RFC'] = $('#RFC').val();

                                obj['FechaConstitucion'] = "";
                            } else if (persona == 2) {
                                // PERSONA MORAL
                                obj['Nombre'] = $('#Nombre_Moral').val();
                                obj['FechaConstitucion'] = $('#Fecha_Constitucion').val();
                                obj['RFC'] = $('#RFC_Moral').val();

                                obj['ApellidoPaterno'] = "";
                                obj['ApellidoMaterno'] = "";
                                obj['Sexo'] = "";
                                obj['FechaNacimiento'] = "";
                            }
                        }
                        else {
                            obj['NuevoCliente'] = 0;
                            // REGISTRA LA SELECION DEL CLIENTE, IdCliente;
                            obj['IdCliente'] = $("#basic option:selected").val()
                        }

                        // METODO DE ENVIO.
                        var IdTipoEntrega = $("#Select_TipoEntrega option:selected").val();
                        obj['IdTipoEntrega'] = IdTipoEntrega;

                        if (IdTipoEntrega == 2) {
                            obj['FechaEntrega'] = $('#Fecha_Entrega').val();
                            obj['IdHorario'] = $("#Select_Horarios option:selected").val();

                            if ($('#NuevoCliente').prop('checked')) {
                                obj['DireccionFiscal'] = 1;
                                obj['IdEstado'] = $("#Select_DEstado option:selected").val();
                                obj['IdPoblacion'] = $("#Select_Delegacion_Municipio option:selected").val();
                                obj['Colonia'] = $("#Select_Colonia option:selected").text();
                                obj['IdCP'] = $("#Select_CP option:selected").val();
                                obj['NumExterior'] = $('#NumeroExterior').val();
                                obj['NumInterior'] = $('#NumeroInterior').val();
                                obj['Calle'] = $('#Calle').val();
                                obj['EntreCalles'] = $('#EntreCalles').val();
                                obj['Referencias'] = $('#Referencias').val();
                            } else {
                                if ($('#NuevaDireccionFiscal').prop('checked')) {
                                    obj['DireccionFiscal'] = 1;
                                    obj['IdEstado'] = $("#Select_DEstado option:selected").val();
                                    obj['IdPoblacion'] = $("#Select_Delegacion_Municipio option:selected").val();
                                    obj['Colonia'] = $("#Select_Colonia option:selected").text();
                                    obj['IdCP'] = $("#Select_CP option:selected").val();
                                    obj['NumExterior'] = $('#NumeroExterior').val();
                                    obj['NumInterior'] = $('#NumeroInterior').val();
                                    obj['Calle'] = $('#Calle').val();
                                    obj['EntreCalles'] = $('#EntreCalles').val();
                                    obj['Referencias'] = $('#Referencias').val();
                                } else {
                                    obj['DireccionFiscal'] = 0;
                                }
                            }


                            if ($('#NuevaDireccionEntrega').prop('checked')) {
                                obj['DireccionEntrega'] = 1;
                                obj['IdEstado2'] = $("#Select_DEstado2 option:selected").val();
                                obj['IdPoblacion2'] = $("#Select_Delegacion_Municipio2 option:selected").val();
                                obj['Colonia2'] = $("#Select_Colonia2 option:selected").text();
                                obj['IdCP2'] = $("#Select_CP2 option:selected").val();
                                obj['NumExterior2'] = $('#NumeroExterior2').val();
                                obj['NumInterior2'] = $('#NumeroInterior2').val();
                                obj['Calle2'] = $('#Calle2').val();
                                obj['EntreCalles2'] = $('#EntreCalles2').val();
                                obj['Referencias2'] = $('#Referencias2').val();
                            } else {
                                obj['DireccionEntrega'] = 0;
                            }
                        }

                        var jsonObject = {
                            "VentaNueva": obj,
                            Objetotaller: talleres
                        };



                        $.ajax({
                        type: "POST",
                        url: "@Url.Action("NuevaVenta", "Ventas")",
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                            success: function (data) {

                                if (data.Resultado == 1) {
                                    talleres = null; // Vaciar la variable talleres después del éxito
                                    sessionStorage.setItem('talleres', JSON.stringify(talleres)); // Actualizar el valor en sessionStorage
                                    swal({
                                    title: "Venta registrada !",
                                    text: "Información registrada !",
                                    icon: "success",
                                    buttons: {
							                confirm: {
								                className : 'btn btn-success'
							                }
						                },
                                    })
                                    .then((value) => {
                                        window.location.href = window.location.href = '@Url.Action("purchase", "Ventas")';
                                    });

                            } else {
                                swal("Venta no registrada !", data.Texto + " !", {
					                icon : "warning",
					                buttons: {
						                confirm: {
							                className : 'btn btn-warning'
						                }
					                },
                                });
                            }

                            $("#btnRegistrarVenta").prop('disabled', false);

	                    },
	                    error: function() {
                            $.notify({
                            message: "Inténtelo mas tarde."
                                }, {
                                    type: 'danger',
                                    allow_dismiss: false,
                                    animate: {
                                        enter: 'animated rollIn',
                                        exit: 'animated rollOut'
                                    }
                            });
                        }
                    });


                    } else {
                        swal("Formulario incompleto !", "Completa el método de envió !", {
					        icon : "warning",
					        buttons: {
						        confirm: {
							        className : 'btn btn-warning'
						        }
					        },
				        });
                    }

                } else {
                    swal("Formulario incompleto !", "Completa el método de pago !", {
					    icon : "warning",
					    buttons: {
						    confirm: {
							    className : 'btn btn-warning'
						    }
					    },
				    });
                }
            } else {
                swal("Formulario incompleto !", "Agrega artículos a la venta!", {
					icon : "warning",
					buttons: {
						confirm: {
							className : 'btn btn-warning'
						}
					},
				});
            }
        });
    });



</script>

<script type="text/javascript">



    // EVALUACION DE LOS FORMULARIOS

    function ValidarForm3() {
        if (ValidarDirecciones()) {
            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);

            $('.wizard .nav-tabs li.active .connecting-line').css({ "border-bottom-left-radius": 0, "border-top-left-radius": 0 });
        }
        else {
            $.notify({
                message: "Formulario incompleto."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    }

    function ValidarDirecciones() {
        var resultado = false;

        var IdEntrega = $("#Select_TipoEntrega option:selected").val();
        var IdCliente = $("#basic option:selected").val();

        var obj = {};

        obj['Id'] = IdCliente;

        var jsonObject = {
            "Cliente": obj
        };


        // BLOQUE 1 PRINCIPAL
        $('#Select_TipoEntrega').css("border", "2px solid #f44336");
        // BLOQUE 2 PRINCIPAL
        $('#Fecha_Entrega').css("border", "2px solid #f44336");
        $('#Select_Horarios').css("border", "2px solid #f44336");


        // BLOQUE 1 PRINCIPAL
        if ($("#Select_TipoEntrega option:selected").val() > 0) {
            $('#Select_TipoEntrega').css("border", "1px solid #c2c2c2");
        }
        // BLOQUE 2 PRINCIPAL
        if ($('#Fecha_Entrega').val().length > 0) {
            $('#Fecha_Entrega').css("border", "1px solid #c2c2c2");
        }
        if ($("#Select_Horarios option:selected").val() > 0) {
            $('#Select_Horarios').css("border", "1px solid #c2c2c2");
        }



        if ($('#NuevaDireccionFiscal').prop('checked')) {
            // DIRECCION FISCAL
            $('#Select_DEstado').css("border", "2px solid #f44336");
            $('#Select_Delegacion_Municipio').css("border", "2px solid #f44336");
            $('#Select_Colonia').css("border", "2px solid #f44336");
            $('#Select_CP').css("border", "2px solid #f44336");
            $('#NumeroExterior').css("border", "2px solid #f44336");
            $('#Calle').css("border", "2px solid #f44336");

            // DIRECCION FISCAL
            if ($("#Select_DEstado option:selected").val() > 0) {
                $('#Select_DEstado').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_Delegacion_Municipio option:selected").val() > 0) {
                $('#Select_Delegacion_Municipio').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_Colonia option:selected").val() > 0) {
                $('#Select_Colonia').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_CP option:selected").val() > 0) {
                $('#Select_CP').css("border", "1px solid #c2c2c2");
            }
            if ($('#NumeroExterior').val().length > 0) {
                $('#NumeroExterior').css("border", "1px solid #c2c2c2");
            }
            if ($('#Calle').val().length > 0) {
                $('#Calle').css("border", "1px solid #c2c2c2");
            }
        }

        if ($('#NuevaDireccionEntrega').prop('checked')) {
            // DIRECCION ENTREGA
            $('#Select_DEstado2').css("border", "2px solid #f44336");
            $('#Select_Delegacion_Municipio2').css("border", "2px solid #f44336");
            $('#Select_Colonia2').css("border", "2px solid #f44336");
            $('#Select_CP2').css("border", "2px solid #f44336");
            $('#NumeroExterior2').css("border", "2px solid #f44336");
            $('#Calle2').css("border", "2px solid #f44336");

            // DIRECCION ENTREGA
            if ($("#Select_DEstado2 option:selected").val() > 0) {
                $('#Select_DEstado2').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_Delegacion_Municipio2 option:selected").val() > 0) {
                $('#Select_Delegacion_Municipio2').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_Colonia2 option:selected").val() > 0) {
                $('#Select_Colonia2').css("border", "1px solid #c2c2c2");
            }
            if ($("#Select_CP2 option:selected").val() > 0) {
                $('#Select_CP2').css("border", "1px solid #c2c2c2");
            }
            if ($('#NumeroExterior2').val().length > 0) {
                $('#NumeroExterior2').css("border", "1px solid #c2c2c2");
            }
            if ($('#Calle2').val().length > 0) {
                $('#Calle2').css("border", "1px solid #c2c2c2");
            }
        }

        // BLOQUE 1 Y 2
        var Bloque12 = false;
        if ($("#Select_TipoEntrega option:selected").val() > 0) {
            if ($('#Fecha_Entrega').val().length > 0) {
                if ($("#Select_Horarios option:selected").val() > 0) {
                    Bloque12 = true;
                }
            }
        }



        // DIRECCION FISCAL
        var DireccionFiscal = false;
        if ($('#NuevaDireccionFiscal').prop('checked')) {
            if ($("#Select_DEstado option:selected").val() > 0) {
                if ($("#Select_Delegacion_Municipio option:selected").val() > 0) {
                    if ($("#Select_Colonia option:selected").val() > 0) {
                        if ($("#Select_CP option:selected").val() > 0) {
                            if ($('#NumeroExterior').val().length > 0) {
                                if ($('#Calle').val().length > 0) {
                                    DireccionFiscal = true;
                                }
                            }
                        }
                    }
                }
            }
        } else {
            DireccionFiscal = true;
        }

        // DIRECCION ENTREGA
        var DireccionEntrega = false;
        if ($('#NuevaDireccionEntrega').prop('checked')) {
            if ($("#Select_DEstado2 option:selected").val() > 0) {
                if ($("#Select_Delegacion_Municipio2 option:selected").val() > 0) {
                    if ($("#Select_Colonia2 option:selected").val() > 0) {
                        if ($("#Select_CP2 option:selected").val() > 0) {
                            if ($('#NumeroExterior2').val().length > 0) {
                                if ($('#Calle2').val().length > 0) {
                                    DireccionEntrega = true;
                                }
                            }
                        }
                    }
                }
            }
        } else {
            DireccionEntrega = true;
        }

        var Inmediata = false;
        var Selecionada = false;

        if ($('#NuevoCliente').prop('checked')) {
            if (IdEntrega == 2) {
                // VALIDAR LA CAPTURA DE LAS NUEVAS DIRECIONES.
                if (Bloque12) {
                    if (DireccionFiscal) {
                        if (DireccionEntrega) {
                            resultado = true;
                        }
                    }
                }
            } else if(IdEntrega == 1){
                // POR ENTREGA INMEDIATA.
                resultado = true;
                Inmediata = true;
            }
        } else{
            // CLIENTE REGISTRADO CON POSIBILIDAD DE REGISTRAR DIRECCION.
            if (IdEntrega == 2) {
                if ($('#NuevaDireccionFiscal').prop('checked')) {
                    if (Bloque12) {
                        if (DireccionFiscal) {
                            if (DireccionEntrega) {
                                resultado = true;
                            }
                        }
                    }
                }
                else {
                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("SeleccionarDireccion", "Ventas")",
                        async: false,
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {
                            console.log(data);
                            /// VALIDACION, MOSTRAR DIRECCIONES, SI NO TIENE REGISTROS OBLIGAR A REGISTRAR UNA DIRECCION.
                            if (data.Select > 0) {
                                if (Bloque12) {
                                    resultado = true;
                                    Selecionada = true;

                                    var direccion = "";
                                    direccion = "<br>" + data.Estado + ", " + data.Poblacion + ", <strong>Col: </strong>" + data.Colonia + ", <strong>CP: </strong>" + data.CP + ", <strong>Calle: </strong> " + data.Calle + ", <strong>NumEx: </strong> " + data.NumExterior;

                                    if (data.NumInterior != null) {
                                        direccion += ",  <strong>NumInt: </strong> " + data.NumInterior;
                                    }

                                    if (data.EntreCalles != null) {
                                        direccion += ",  <strong>Entre calles: </strong> " + data.EntreCalles;
                                    }

                                    if (data.Referencias != null) {
                                        direccion += ",  <strong>Referencias: </strong> " + data.Referencias;
                                    }


                                    $('#MV_Direccion').html(direccion);

                                }
                            } else {
                                $.notify({
                                message: "Se requiere una dirección para continuar."
                                    }, {
                                        type: 'danger',
                                        allow_dismiss: false,
                                        animate: {
                                            enter: 'animated rollIn',
                                            exit: 'animated rollOut'
                                        }
                                });
                            }

	                    },
	                    error: function() {
                            $.notify({
                            message: "Inténtelo mas tarde."
                                }, {
                                    type: 'danger',
                                    allow_dismiss: false,
                                    animate: {
                                        enter: 'animated rollIn',
                                        exit: 'animated rollOut'
                                    }
                            });
                        }
                    });
                }

            } else if(IdEntrega == 1){
                // POR ENTREGA INMEDIATA.
                resultado = true;
                Inmediata = true;
            }
        }

        if (Inmediata) {
            $('#Fecha_Hora_Entrega').text("No aplica");
            $('#MV_Direccion').text("No aplica");
        } else {
            $('#Fecha_Hora_Entrega').text($('#Fecha_Entrega').val() + " - " + $("#Select_Horarios option:selected").text());
            if (!Selecionada) {

                var direccion = "";

                if ($('#NuevaDireccionFiscal').prop('checked')) {

                    if ($('#NuevaDireccionEntrega').prop('checked')) {

                        direccion = "<br>" + $("#Select_DEstado2 option:selected").text() + ", " + $("#Select_Delegacion_Municipio2 option:selected").text() + ", <strong>Col: </strong>" + $("#Select_Colonia2 option:selected").text() + ", <strong>CP: </strong>" + $("#Select_CP2 option:selected").text() + ", <strong>Calle: </strong> " + $('#Calle2').val() + ", <strong>NumEx: </strong> " + $('#NumeroExterior2').val();
                        if ($('#NumeroInterior2').val().length > 0) {
                            direccion += ",  <strong>NumInt: </strong> " + $('#NumeroInterior2').val();
                        }
                        if ($('#EntreCalles2').val().length > 0) {
                            direccion += ",  <strong>Entre calles: </strong> " + $('#EntreCalles2').val();
                        }
                        if ($('#Referencias2').val().length > 0) {
                            direccion += ",  <strong>Referencias: </strong> " + $('#Referencias2').val();
                        }

                    }
                    else {

                        direccion = "<br>" + $("#Select_DEstado option:selected").text() + ", " + $("#Select_Delegacion_Municipio option:selected").text() + ", <strong>Col: </strong>" + $("#Select_Colonia option:selected").text() + ", <strong>CP: </strong>" + $("#Select_CP option:selected").text() + ", <strong>Calle: </strong> " + $('#Calle').val() + ", <strong>NumEx: </strong> " + $('#NumeroExterior').val();
                        if ($('#NumeroInterior').val().length > 0) {
                            direccion += ",  <strong>NumInt: </strong> " + $('#NumeroInterior').val();
                        }
                        if ($('#EntreCalles').val().length > 0) {
                            direccion += ",  <strong>Entre calles: </strong> " + $('#EntreCalles').val();
                        }
                        if ($('#Referencias').val().length > 0) {
                            direccion += ",  <strong>Referencias: </strong> " + $('#Referencias').val();
                        }
                    }
                }



                $('#MV_Direccion').html(direccion);
            }

        }

        return resultado;
    }

    function ResumenCompra()
    {
        // LIMPIA DATOS
        $("#MV_Nombre").text("");
        $("#MV_Persona").text("");
        $("#MV_TitleFecha").text("");
        $("#MV_Fecha").text("");
        $("#MV_RFC").text("");
        $("#MV_TitleSexo").text("");
        $("#MV_Sexo").text("");
        $("#MV_TipoCliente").text("");
        $("#MV_Origen").text("");
        $("#MV_Correo").text("");
        $("#MV_Movil").text("");
        $("#MV_Local").text("");
        $("#MV_Vendedor").text("");
        $("#MV_Sucursal").text("");
        $("#MV_Forma_Pago").text("");

        $("#MV_Nombre2").text("");
        $("#MV_Persona2").text("");
        $("#MV_TitleFecha2").text("");
        $("#MV_Fecha2").text("");
        $("#MV_RFC2").text("");
        $("#MV_TitleSexo2").text("");
        $("#MV_Sexo2").text("");
        $("#MV_TipoCliente2").text("");
        $("#MV_Origen2").text("");
        $("#MV_Correo2").text("");
        $("#MV_Movil2").text("");
        $("#MV_Local2").text("");
        $("#MV_Vendedor2").text("");
        $("#MV_Sucursal2").text("");
        $("#MV_Forma_Pago2").text("");


        // COLOCAR CANTIDAD DE PRODUCTOS
        $.ajax({
            type: "POST",
            url: "@Url.Action("ConsultaProductosAgregados", "Ventas")",
            data: '',//JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {

                    if (respuesta.length > 0) {
                        $("#Table_ArticulosResumen > tbody").empty();
                        $("#Table_ArticulosResumen2 > tbody").empty();

                        var htmlTags = '';
                        for (var b = 0; b < respuesta.length; b++) {
                            htmlTags += '' +
                                '<tr>' +
                                    '<th>' + respuesta[b].Producto.Nombre + ' <br /><strong>SKU:</strong> ' + respuesta[b].Producto.SKU + ' </th>'+
                                    '<td>' + respuesta[b].Cantidad +
                                    '</td>' +
                                    '<td class="text-center subtotal3">' +
                                        '<br>' +
                                        '<strong><p Id="PTotal_' + respuesta[b].IdProducto + '"> ' + (respuesta[b].Precio * respuesta[b].Cantidad) + ' </p><strong>' +
                                    '</td>' +
                                    '<td>';
                            if (respuesta[b].BackOrder == 1) {
                                htmlTags += '<button type="button" class="btn btn-icon btn-round btn-warning">' +
                                            '<i class="fa fa-exclamation-circle"></i>' +
                                        '</button>';
                                }
                            htmlTags += '</td>' +
                                '</tr>';
                        }
                        $('#Table_ArticulosResumen tbody').append(htmlTags);
                        $('#Table_ArticulosResumen2 tbody').append(htmlTags);

                    }
	        },
	        error: function() {
                $.notify({
                message: "Productos no registrados, inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });

        // MUESTRA INFORMACION DEL FROM  3 RESUMEN DE COMPRA
        // TOMAR POR CONSULTA O POR NUEVO CLIENTE
        if ($('#NuevoCliente').prop('checked')) {
            // MOSTRAR DATOS DEL NUEVO CLIENTE.
            $("#MV_Nombre").text($('#Nombre').val() + " " + $('#Apellido_Paterno').val() + " " + $('#Apellido_Materno').val());
            $("#MV_Nombre2").text($('#Nombre').val() + " " + $('#Apellido_Paterno').val() + " " + $('#Apellido_Materno').val());
            var persona = $("#Select_Persona option:selected").val();

            if (persona == 1) {
                $("#MV_Persona").text("Física");
                $("#MV_TitleFecha").text("Fecha nacimiento:");
                $("#MV_Fecha").text($('#Fecha_Nacimiento').val());
                $("#MV_RFC").text($('#RFC').val());
                $("#MV_TitleSexo").text("Sexo:");

                $("#MV_Persona2").text("Física");
                $("#MV_TitleFecha2").text("Fecha nacimiento:");
                $("#MV_Fecha2").text($('#Fecha_Nacimiento').val());
                $("#MV_RFC2").text($('#RFC').val());
                $("#MV_TitleSexo2").text("Sexo:");

                var Sexo = $("#Select_Sexo option:selected").val();

                if (Sexo == 1) {
                    $("#MV_Sexo").text("Masculino");
                    $("#MV_Sexo2").text("Masculino");
                } else {
                    $("#MV_Sexo").text("Femenino");
                    $("#MV_Sexo2").text("Femenino");
                }

            }
            else {
                $("#MV_Persona").text("Moral");
                $("#MV_TitleFecha").text("Fecha constitución:");
                $("#MV_Fecha").text($('#Fecha_Constitucion').val());
                $("#MV_RFC").text($('#RFC_Moral').val());

                $("#MV_Persona2").text("Moral");
                $("#MV_TitleFecha2").text("Fecha constitución:");
                $("#MV_Fecha2").text($('#Fecha_Constitucion').val());
                $("#MV_RFC2").text($('#RFC_Moral').val());

            }
            $("#MV_TipoCliente").text($("#Clasificacion option:selected").text());
            $("#MV_Origen").text($("#Origen_Cliente option:selected").text());
            $("#MV_Correo").text($('#Correo_Electronico').val());
            $("#MV_Movil").text($('#Telefono_Movil').val());
            $("#MV_Local").text($('#Telefono_Local').val());

            $("#MV_TipoCliente2").text($("#Clasificacion option:selected").text());
            $("#MV_Origen2").text($("#Origen_Cliente option:selected").text());
            $("#MV_Correo2").text($('#Correo_Electronico').val());
            $("#MV_Movil2").text($('#Telefono_Movil').val());
            $("#MV_Local2").text($('#Telefono_Local').val());


        } else {
            // CONSULTAR DATOS DEL CLIENTE SELECIONADO. (AJAX);
            var IdCliente = $("#basic option:selected").val();

            var obj = {};

            obj['Id'] = IdCliente;

            var jsonObject = {
                "Cliente": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Cliente_Seleccionar_Id", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    $("#MV_Nombre").text(data.Nombre);
                    $("#MV_Nombre2").text(data.Nombre);
                    if (data.TipoPersona == 1) {
                        $("#MV_Persona").text("Física");
                        $("#MV_TitleFecha").text("Fecha nacimiento:");
                        $("#MV_Fecha").text(data.FechaNacimiento.substring(0, 10));
                        $("#MV_RFC").text(data.RFC);
                        $("#MV_TitleSexo").text("Sexo:");

                        $("#MV_Persona2").text("Física");
                        $("#MV_TitleFecha2").text("Fecha nacimiento:");
                        $("#MV_Fecha2").text(data.FechaNacimiento.substring(0, 10));
                        $("#MV_RFC2").text(data.RFC);
                        $("#MV_TitleSexo2").text("Sexo:");

                        if (data.Sexo == 1) {
                            $("#MV_Sexo").text("Masculino");
                            $("#MV_Sexo2").text("Masculino");
                        } else {
                            $("#MV_Sexo").text("Femenino");
                            $("#MV_Sexo2").text("Femenino");
                        }

                    } else {
                        $("#MV_Persona").text("Moral");
                        $("#MV_TitleFecha").text("Fecha constitución:");
                        $("#MV_Fecha").text(data.FechaConstitucion.substring(0, 10));
                        $("#MV_RFC").text(data.RFC);

                        $("#MV_Persona2").text("Moral");
                        $("#MV_TitleFecha2").text("Fecha constitución:");
                        $("#MV_Fecha2").text(data.FechaConstitucion.substring(0, 10));
                        $("#MV_RFC2").text(data.RFC);
                    }
                    $("#MV_TipoCliente").text(data.TipoCliente);
                    $("#MV_Origen").text(data.OrigenCliente);
                    $("#MV_Correo").text(data.Correo);
                    $("#MV_Movil").text(data.TelefonoMovil);
                    $("#MV_Local").text(data.TelefonoLocal);

                    $("#MV_TipoCliente2").text(data.TipoCliente);
                    $("#MV_Origen2").text(data.OrigenCliente);
                    $("#MV_Correo2").text(data.Correo);
                    $("#MV_Movil2").text(data.TelefonoMovil);
                    $("#MV_Local2").text(data.TelefonoLocal);
                },
                error: Errores
            });


        }

        $("#MV_Vendedor").text($("#Select_Vendedores option:selected").text());
        $("#MV_Sucursal").text($("#Sucursal option:selected").text());
        $("#MV_Forma_Pago").text($("#Select_FormaPago option:selected").text());

        $("#MV_Vendedor2").text($("#Select_Vendedores option:selected").text());
        $("#MV_Sucursal2").text($("#Sucursal option:selected").text());
        $("#MV_Forma_Pago2").text($("#Select_FormaPago option:selected").text());

        CargarDireciones();
    }

    // VALIDAR FORMATO DE PAGO Y CLIENTE
    function ValidarForm2()
    {

        if (ValidarPago()) {
            if ($('#NuevoCliente').prop('checked')) {
                if (ValidarEmail()) {
                    if (ValidarTelefono()) {
                        if (ValidarTelefonoLocal()) {
                            if (ValidarFormualrioRFC()) {
                                if (BusquedaRFC()) {
                                    var $active = $('.wizard .nav-tabs li.active');
                                    $active.next().removeClass('disabled');
                                    nextTab($active);

                                    $('.wizard .nav-tabs li.active .connecting-line').css({ "border-bottom-left-radius": 0, "border-top-left-radius": 0 });

                                    ResumenCompra();
                                }
                            }
                        }
                    }
                }
            } else {
                var $active = $('.wizard .nav-tabs li.active');
                $active.next().removeClass('disabled');
                nextTab($active);

                $('.wizard .nav-tabs li.active .connecting-line').css({ "border-bottom-left-radius": 0, "border-top-left-radius": 0 });

                ResumenCompra();
            }
        } else {
            $.notify({
                message: "Formulario incompleto."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    }

    function ValidarPago() {
        var resultado = false;

        $('#Fecha_Venta').css("border", "2px solid #f44336");
        $('#Select_Vendedores').css("border", "2px solid #f44336");
        $('#Sucursal').css("border", "2px solid #f44336");
        $('#Select_FormaPago').css("border", "2px solid #f44336");

        // DATOS CONTACTO
        $('#Select_Persona').css("border", "2px solid #f44336");
        $('#Correo_Electronico').css("border", "2px solid #f44336");
        $('#Telefono_Movil').css("border", "2px solid #f44336");
        $('#Clasificacion').css("border", "2px solid #f44336");
        $('#Origen_Cliente').css("border", "2px solid #f44336");
        //$('#Sucursal').css("border", "2px solid #f44336");

        // PERSONA FISICA
        $('#Nombre').css("border", "2px solid #f44336");
        $('#Apellido_Paterno').css("border", "2px solid #f44336");
        $('#Select_Sexo').css("border", "2px solid #f44336");
        $('#Fecha_Nacimiento').css("border", "2px solid #f44336");
        $('#RFC').css("border", "2px solid #f44336");
        // PERSONA MORAL
        $('#Nombre_Moral').css("border", "2px solid #f44336");
        $('#Fecha_Constitucion').css("border", "2px solid #f44336");
        $('#RFC_Moral').css("border", "2px solid #f44336");

        if ($("#Select_Vendedores option:selected").val() > 0) {
            $('#Select_Vendedores').css("border", "1px solid #c2c2c2");
        }

        if ($("#Sucursal option:selected").val() > 0) {
            $('#Sucursal').css("border", "1px solid #c2c2c2");
        }

        if ($("#Select_FormaPago option:selected").val() > 0) {
            $('#Select_FormaPago').css("border", "1px solid #c2c2c2");
        }

        if ($('#Fecha_Venta').val().length > 0) {
            $('#Fecha_Venta').css("border", "1px solid #c2c2c2");
        }

        if ($('#NuevoCliente').prop('checked')) {

            if ($("#Select_Persona option:selected").val() > 0) {
                $('#Select_Persona').css("border", "1px solid #c2c2c2");
            }

            if ($('#Correo_Electronico').val().length > 0) {
                $('#Correo_Electronico').css("border", "1px solid #c2c2c2");
            }

            if ($('#Telefono_Movil').val().length > 0) {
                $('#Telefono_Movil').css("border", "1px solid #c2c2c2");
            }

            if ($("#Clasificacion option:selected").val() > 0) {
                $('#Clasificacion').css("border", "1px solid #c2c2c2");
            }

            if ($("#Origen_Cliente option:selected").val() > 0) {
                $('#Origen_Cliente').css("border", "1px solid #c2c2c2");
            }

            if ($("#Sucursal option:selected").val() > 0) {
                $('#Sucursal').css("border", "1px solid #c2c2c2");
            }

            if ($('#Telefono_Movil').val().length > 9) {
                $('#Telefono_Movil').css("border", "1px solid #c2c2c2");
            } else {
                $('#Telefono_Movil').css("border", "2px solid #f44336");
            }

            if ($('#Telefono_Local').val().length > 9) {
                $('#Telefono_Local').css("border", "1px solid #c2c2c2");
            } else if ($('#Telefono_Local').val().length == 0) {
                $('#Telefono_Local').css("border", "1px solid #c2c2c2");
            }
            else {
                $('#Telefono_Local').css("border", "2px solid #f44336");
            }

            // PERSONA FISICA
            var persona = $("#Select_Persona option:selected").val();

            if (persona == 1) {

                $('#Nombre_Moral').css("border", "1px solid #c2c2c2");
                $('#Fecha_Constitucion').css("border", "1px solid #c2c2c2");
                $('#RFC_Moral').css("border", "1px solid #c2c2c2");

                if ($('#Nombre').val().length > 0) {
                    $('#Nombre').css("border", "1px solid #c2c2c2");
                }

                if ($('#Apellido_Paterno').val().length > 0) {
                    $('#Apellido_Paterno').css("border", "1px solid #c2c2c2");
                }

                if ($("#Select_Sexo option:selected").val() > 0) {
                    $('#Select_Sexo').css("border", "1px solid #c2c2c2");
                }

                if ($('#Fecha_Nacimiento').val().length > 0) {
                    $('#Fecha_Nacimiento').css("border", "1px solid #c2c2c2");
                }

                if ($('#RFC').val().length > 0) {
                    $('#RFC').css("border", "1px solid #c2c2c2");
                }

            } else if (persona == 2) {
                $('#Nombre').css("border", "1px solid #c2c2c2");
                $('#Apellido_Paterno').css("border", "1px solid #c2c2c2");
                $('#Select_Sexo').css("border", "1px solid #c2c2c2");
                $('#Fecha_Nacimiento').css("border", "1px solid #c2c2c2");
                $('#RFC').css("border", "1px solid #c2c2c2");

                if ($('#Nombre_Moral').val().length > 0) {
                    $('#Nombre_Moral').css("border", "1px solid #c2c2c2");
                }

                if ($('#Fecha_Constitucion').val().length > 0) {
                    $('#Fecha_Constitucion').css("border", "1px solid #c2c2c2");
                }

                if ($('#RFC_Moral').val().length > 0) {
                    $('#RFC_Moral').css("border", "1px solid #c2c2c2");
                }

            } else {
                $('#Nombre').css("border", "1px solid #c2c2c2");
                $('#Apellido_Paterno').css("border", "1px solid #c2c2c2");
                $('#Select_Sexo').css("border", "1px solid #c2c2c2");
                $('#Fecha_Nacimiento').css("border", "1px solid #c2c2c2");
                $('#RFC').css("border", "1px solid #c2c2c2");

                $('#Nombre_Moral').css("border", "1px solid #c2c2c2");
                $('#Fecha_Constitucion').css("border", "1px solid #c2c2c2");
                $('#RFC_Moral').css("border", "1px solid #c2c2c2");
            }

        }

         var venta = false;
        // CONTACTO
        if ($("#Select_Vendedores option:selected").val() > 0) {
            if ($("#Sucursal option:selected").val() > 0) {
                if ($("#Select_FormaPago option:selected").val() > 0) {
                    if ($("#Fecha_Venta").val().length > 0) {
                        if (!$('#NuevoCliente').prop('checked')) {
                            if ($("#basic option:selected").val() > 0) {
                                venta = true;
                            } else {
                                $.notify({
                                    message: "Busca o agrega un nuevo cliente."
                                }, {
                                    type: 'danger',
                                    allow_dismiss: false,
                                    animate: {
                                        enter: 'animated rollIn',
                                        exit: 'animated rollOut'
                                    }
                                });
                            }
                        } else {
                            venta = true;
                        }
                    }
                }
            }
        }

        var contacto = false;
        // CONTACTO
        if ($("#Select_Persona option:selected").val() > 0) {
            if ($('#Correo_Electronico').val().length > 0) {
                if ($('#Telefono_Movil').val().length > 0) {
                    if ($("#Clasificacion option:selected").val() > 0) {
                        if ($("#Origen_Cliente option:selected").val() > 0) {
                            if ($("#Sucursal option:selected").val() > 0) {
                                contacto = true;
                            }
                        }
                    }
                }
            }
        }

        var TipoPersona = false;
        if ($('#NuevoCliente').prop('checked')) {
            // PERSONA FISICA
            if (persona == 1) {
                if ($('#Nombre').val().length > 0) {
                    if ($('#Apellido_Paterno').val().length > 0) {
                        if ($("#Select_Sexo option:selected").val() > 0) {
                            if ($('#Fecha_Nacimiento').val().length > 0) {
                                if ($('#RFC').val().length > 0) {
                                    TipoPersona = true;
                                }
                            }
                        }
                    }
                }
            } else if (persona == 2) {
                if ($('#Nombre_Moral').val().length > 0) {
                    if ($('#Fecha_Constitucion').val().length > 0) {
                        if ($('#RFC_Moral').val().length > 0) {
                            TipoPersona = true;
                        }
                    }
                }
            }
        }

        if (venta) {
            if ($('#NuevoCliente').prop('checked')) {
                if (contacto) {
                    if (TipoPersona) {
                        resultado = true;
                    }
                }
            } else {
                resultado = true;
            }
        }

        return resultado;
    }

    // VALIDA EXITENCIA DE ARTIUCLOS A LA VETA
    function ValidarForm1() {
        //
        if (ValidarArticulos()) {
            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);

            $('.wizard .nav-tabs li.active .connecting-line').css({ "border-bottom-left-radius": 0, "border-top-left-radius": 0 });
            ResumenCompra();
        } else {
            $.notify({
                message: "Debes de agregar un artículos en la venta."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    }

    function ValidarArticulos() {
        var resultado = false;
        var num = 0;
        $.ajax({
            type: "POST",
            url: "@Url.Action("ConsultaProductosAgregados", "Ventas")",
            async: false,
            data: '',//JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                if (respuesta.length > 0) {
                    num = 1;
                }
	        },
	        error: function() {
                $.notify({
                message: "Inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });

        if (num > 0) {
            resultado = true;
        }

        return resultado;
    }

    function ValidarEmail() {
        var respuesta = false;

        if (CorreoFrom() == "ok") {
            $('#Correo_Electronico').css("border", "1px solid #c2c2c2");
            respuesta = true;
        } else {

            $('#Correo_Electronico').css("border", "2px solid #f44336");

            $.notify({
                //icon: 'fa fa-paw',
                message: "Correo electrónico invalido."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
        return respuesta;
    }

    function ValidaTelefonoLocal() {
        if ($('#Telefono_Local').val().length > 9) {
            $('#Telefono_Local').css("border", "1px solid #c2c2c2");
        } else if ($('#Telefono_Local').val().length == 0) {
            $('#Telefono_Local').css("border", "1px solid #c2c2c2");
        }
        else {
            $('#Telefono_Local').css("border", "2px solid #f44336");
        }
    }

    function ValidaTelefono() {

        if ($('#Telefono_Movil').val().length > 9) {
            $('#Telefono_Movil').css("border", "1px solid #c2c2c2");
        } else {
            $('#Telefono_Movil').css("border", "2px solid #f44336");
        }
    }

    function ValidarTelefonoLocal()
    {
        var respuesta = false;

        if ($('#Telefono_Local').val().length > 9) {
            respuesta = true;
        } else if ($('#Telefono_Local').val().length == 0) {
            respuesta = true;
        }
        else {
            $.notify({
                message: "Teléfono local invalido."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
        return respuesta;

    }

    function ValidarTelefono() {
        var respuesta = false;
        if ($('#Telefono_Movil').val().length > 9) {
            respuesta = true;
        } else {
            $('#Telefono_Movil').css("border", "2px solid #f44336");

            $.notify({
                //icon: 'fa fa-paw',
                message: "Teléfono móvil invalido."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });

        }

        return respuesta;

    }

    function ValidaInput(name) {
        if ($('#' + name).val().length > 0) {
            $('#' + name).css("border", "1px solid #c2c2c2");
        } else {
            $('#' + name).css("border", "2px solid #f44336");
        }
    }

    function ValidaSelect(name) {
        if ($('#'+name+' option:selected').val() > 0) {
            $('#' + name).css("border", "1px solid #c2c2c2");
        } else {
            $('#' + name).css("border", "2px solid #f44336");
        }
    }

    function ValidarFormualrioRFC() {
        var respuesta = false;
        var persona = $("#Select_Persona option:selected").val();
        if (persona == 1) {
            var rfc = $('#RFC').val().trim().toUpperCase();

            var rfcCorrecto = rfcValido(rfc);
            if (rfcCorrecto) {
                respuesta = true;
            } else {
                $('#RFC').css("border", "2px solid #f44336");
                $('#RFC_Mensaje').text("RFC no valido.");
                $.notify({
                message: "RFC no valido."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        } else if (persona == 2) {
            var rfc = $('#RFC_Moral').val().trim().toUpperCase();
            var rfcCorrecto = rfcValido(rfc);
            if (rfcCorrecto) {
                respuesta = true;
            } else {
                $('#RFC_Moral').css("border", "2px solid #f44336");
                $('#RFC_MoralMensaje').text("RFC no valido.");
                $.notify({
                message: "RFC no valido."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        }

        return respuesta;
    }

    $(document).ready(function () {
        //$('.nav-tabs > li a[title]').tooltip();

        //$('a[data-toggle="tab"]').on('show.bs.tab', function (e) {

        //    var $target = $(e.target);

        //    if ($target.parent().hasClass('disabled')) {
        //        return false;
        //    }
        //});

        //$(".next-step").click(function (e) {

        //    var $active = $('.wizard .nav-tabs li.active');
        //    $active.next().removeClass('disabled');
        //    nextTab($active);

        //    $('.wizard .nav-tabs li.active .connecting-line').css({ "border-bottom-left-radius": 0, "border-top-left-radius": 0 });

        //});

        $(".prev-step").click(function (e) {

            var $active = $('.wizard .nav-tabs li.active');
            prevTab($active);

        });
    });
    function nextTab(elem) {
        $(elem).next().find('a[data-toggle="tab"]').click();
    }
    function prevTab(elem) {
        $(elem).prev().find('a[data-toggle="tab"]').click();
    }

</script>


<script>

    $(document).on('change', '#Select_TipoEntrega', function (event) {

        var IdEntrega = $("#Select_TipoEntrega option:selected").val();

        $("#NuevaCargaDireccion").css("display", "none");
        $("#View_List_DireccionesView_List_Direcciones").css("display", "none");
        $("#Direcciones_Seleccionar_List_IdCliente").html("");

        if ($('#NuevoCliente').prop('checked')) {

            if (IdEntrega > 1) {
                // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
                $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
                $("#Categoria_DireccionesEntrega").text("");
                $("#SeleccionarDireccionEntrega").text("Cancelar");
                $("#NuevaCargaDireccion").show();
                $("#View_List_DireccionEntrega").show();
                $("#SeleccionarDireccionFiscal").css("display", "none");

                $("#View_List_DireccionFiscal").css("display", "none");
                $("#Agregar_DireccionFiscal").show();
                $("#Form_DireccionFiscal").show();

            } else {
                $("#NuevaCargaDireccion").css("display", "none");
            }
        } else {
            // CLIENTE REGISTRADO CON POSIBILIDAD DE REGISTRAR DIRECCION.
            if (IdEntrega > 1) {
                //$("#NuevaCargaDireccion").show();

                var IdCliente = $("#basic option:selected").val();

                var obj = {};

                obj['Id'] = IdCliente;

                var jsonObject = {
                    "Cliente": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Direcciones_Seleccionar_List_IdCliente", "Ventas")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        /// VALIDACION, MOSTRAR DIRECCIONES, SI NO TIENE REGISTROS OBLIGAR A REGISTRAR UNA DIRECCION.

                        console.log(data);
                        if (data.length > 0) {

                            $("#NuevaCargaDireccion").show();
                            $("#View_List_DireccionesView_List_Direcciones").show();
                            $("#Direcciones_Seleccionar_List_IdCliente").html("");

                            var DireccionesCliente = "";

                            for (var b = 0; b < data.length; b++) {

                                var direccion = "";
                                direccion = data[b].Estado + ", " + data[b].Poblacion + ", <strong>Col: </strong>" + data[b].Colonia + ", <strong>CP: </strong>" + data[b].CP + ", <strong>Calle: </strong> " + data[b].Calle + ", <strong>NumEx: </strong> " + data[b].NumExterior;
                                if (data[b].NumInterior.length > 0) {
                                    direccion += ",  <strong>NumInt: </strong> " + data[b].NumInterior;
                                }
                                if (data[b].EntreCalles.length > 0) {
                                    direccion += ",  <strong>Entre calles: </strong> " + data[b].EntreCalles;
                                }
                                if (data[b].Referencias.length > 0) {
                                    direccion += ",  <strong>Referencias: </strong> " + data[b].Referencias;
                                }


                                DireccionesCliente +=
                                    "<div class='d-flex'>" +
                                        "<div class='avatar avatar-online'>";
                                            if (data[b].FiscalEntrega == 1) {
                                                DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-info'>F</span>";
                                            } else {
                                                DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-secondary'>E</span>";
                                            }
                                DireccionesCliente +=
                                        "</div>" +
                                        "<div class='flex-1 ml-3 pt-1'>";
                                            if (data[b].FiscalEntrega == 1) {
                                                DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-warning pl-3'>Fiscal</span></h6>";
                                            } else {
                                                DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-success pl-3'>Entrega</span></h6>";
                                            }
                                DireccionesCliente +=
                                            "<span class='text-muted'>" + direccion + "</span>"+
                                        "</div>"+
                                        "<div class='float-right pt-1'>";
                                            if (data[b].Select == 1) {
                                DireccionesCliente +=
                                                "<button type='button' class='btn btn-icon btn-round btn-success' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                                    "<i class='fa fa-check'></i>" +
                                                "</button>";
                                            } else {
                                DireccionesCliente +=
                                                "<button type='button' class='btn btn-icon btn-default btn-round' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                                    "<i class='fa fa-times'></i>" +
                                                "</button>";
                                            }
                                DireccionesCliente +=
                                        "</div>"+
                                    "</div>"+
                                    "<div class='separator-dashed'></div>";
                            }

                            $("#Direcciones_Seleccionar_List_IdCliente").html(DireccionesCliente);



                        } else {
                            // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
                            $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
                            $("#Categoria_DireccionesEntrega").text("");
                            $("#SeleccionarDireccionEntrega").text("Cancelar");
                            $("#NuevaCargaDireccion").show();
                            $("#View_List_DireccionEntrega").show();
                            $("#SeleccionarDireccionFiscal").css("display", "none");

                            $("#View_List_DireccionFiscal").css("display", "none");
                            $("#Agregar_DireccionFiscal").show();
                            $("#Form_DireccionFiscal").show();
                        }

	                },
	                error: function() {
                        $.notify({
                        message: "Inténtelo mas tarde."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                        });
                    }
                });


            } else {
                $("#NuevaCargaDireccion").css("display", "none");
            }
        }

    });

    function CargarDireciones() {
        var IdEntrega = $("#Select_TipoEntrega option:selected").val();

        $("#NuevaCargaDireccion").css("display", "none");
        $("#View_List_DireccionesView_List_Direcciones").css("display", "none");
        $("#Direcciones_Seleccionar_List_IdCliente").html("");

        $("#NuevaCargaDireccion").css("display", "none");
        $("#View_List_DireccionEntrega").css("display", "none");
        $("#Agregar_DireccionFiscal").css("display", "none");
        $("#Form_DireccionFiscal").css("display", "none");

        $("#Agregar_DireccionEntrega").css("display", "none");
        $("#Form_DireccionEntrega").css("display", "none");

        if ($('#NuevoCliente').prop('checked')) {

            if (IdEntrega > 1) {
                // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
                $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
                $("#Categoria_DireccionesEntrega").text("");
                $("#SeleccionarDireccionEntrega").text("Cancelar");
                $("#NuevaCargaDireccion").show();
                $("#View_List_DireccionEntrega").show();
                $("#SeleccionarDireccionFiscal").css("display", "none");

                $("#View_List_DireccionFiscal").css("display", "none");
                $("#Agregar_DireccionFiscal").show();
                $("#Form_DireccionFiscal").show();

            } else {
                $("#NuevaCargaDireccion").css("display", "none");
            }
        } else {
            // CLIENTE REGISTRADO CON POSIBILIDAD DE REGISTRAR DIRECCION.
            if (IdEntrega > 1) {
                //$("#NuevaCargaDireccion").show();

                var IdCliente = $("#basic option:selected").val();

                var obj = {};

                obj['Id'] = IdCliente;

                var jsonObject = {
                    "Cliente": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Direcciones_Seleccionar_List_IdCliente", "Ventas")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        /// VALIDACION, MOSTRAR DIRECCIONES, SI NO TIENE REGISTROS OBLIGAR A REGISTRAR UNA DIRECCION.

                        console.log(data);
                        if (data.length > 0) {

                            $("#NuevaCargaDireccion").show();
                            $("#View_List_DireccionesView_List_Direcciones").show();
                            $("#Direcciones_Seleccionar_List_IdCliente").html("");

                            var DireccionesCliente = "";

                            for (var b = 0; b < data.length; b++) {

                                var direccion = "";
                                direccion = data[b].Estado + ", " + data[b].Poblacion + ", <strong>Col: </strong>" + data[b].Colonia + ", <strong>CP: </strong>" + data[b].CP + ", <strong>Calle: </strong> " + data[b].Calle + ", <strong>NumEx: </strong> " + data[b].NumExterior;
                                if (data[b].NumInterior.length > 0) {
                                    direccion += ",  <strong>NumInt: </strong> " + data[b].NumInterior;
                                }
                                if (data[b].EntreCalles.length > 0) {
                                    direccion += ",  <strong>Entre calles: </strong> " + data[b].EntreCalles;
                                }
                                if (data[b].Referencias.length > 0) {
                                    direccion += ",  <strong>Referencias: </strong> " + data[b].Referencias;
                                }


                                DireccionesCliente +=
                                    "<div class='d-flex'>" +
                                        "<div class='avatar avatar-online'>";
                                            if (data[b].FiscalEntrega == 1) {
                                                DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-info'>F</span>";
                                            } else {
                                                DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-secondary'>E</span>";
                                            }
                                DireccionesCliente +=
                                        "</div>" +
                                        "<div class='flex-1 ml-3 pt-1'>";
                                            if (data[b].FiscalEntrega == 1) {
                                                DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-warning pl-3'>Fiscal</span></h6>";
                                            } else {
                                                DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-success pl-3'>Entrega</span></h6>";
                                            }
                                DireccionesCliente +=
                                            "<span class='text-muted'>" + direccion + "</span>"+
                                        "</div>"+
                                        "<div class='float-right pt-1'>";
                                            if (data[b].Select == 1) {
                                DireccionesCliente +=
                                                "<button type='button' class='btn btn-icon btn-round btn-success' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                                    "<i class='fa fa-check'></i>" +
                                                "</button>";
                                            } else {
                                DireccionesCliente +=
                                                "<button type='button' class='btn btn-icon btn-default btn-round' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                                    "<i class='fa fa-times'></i>" +
                                                "</button>";
                                            }
                                DireccionesCliente +=
                                        "</div>"+
                                    "</div>"+
                                    "<div class='separator-dashed'></div>";
                            }

                            $("#Direcciones_Seleccionar_List_IdCliente").html(DireccionesCliente);



                        } else {
                            // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
                            $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
                            $("#Categoria_DireccionesEntrega").text("");
                            $("#SeleccionarDireccionEntrega").text("Cancelar");
                            $("#NuevaCargaDireccion").show();
                            $("#View_List_DireccionEntrega").show();
                            $("#SeleccionarDireccionFiscal").css("display", "none");

                            $("#View_List_DireccionFiscal").css("display", "none");
                            $("#Agregar_DireccionFiscal").show();
                            $("#Form_DireccionFiscal").show();
                        }

	                },
	                error: function() {
                        $.notify({
                        message: "Inténtelo mas tarde."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                        });
                    }
                });


            } else {
                $("#NuevaCargaDireccion").css("display", "none");
            }
        }
    }

    function SeleccionarDireccion(Id) {

        var IdCliente = $("#basic option:selected").val();

        var obj = {};

        obj['Id'] = IdCliente;
        obj['Flag'] = Id;

        var jsonObject = {
            "Cliente": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("DireccionSeleccionada", "Ventas")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                /// VALIDACION, MOSTRAR DIRECCIONES, SI NO TIENE REGISTROS OBLIGAR A REGISTRAR UNA DIRECCION.

                console.log(data);
                if (data.length > 0) {

                    $("#NuevaCargaDireccion").show();
                    $("#View_List_DireccionesView_List_Direcciones").show();
                    $("#Direcciones_Seleccionar_List_IdCliente").html("");

                    var DireccionesCliente = "";

                    for (var b = 0; b < data.length; b++) {

                        var direccion = "";
                        direccion = data[b].Estado + ", " + data[b].Poblacion + ", <strong>Col: </strong>" + data[b].Colonia + ", <strong>CP: </strong>" + data[b].CP + ", <strong>Calle: </strong> " + data[b].Calle + ", <strong>NumEx: </strong> " + data[b].NumExterior;
                        if (data[b].NumInterior.length > 0) {
                            direccion += ",  <strong>NumInt: </strong> " + data[b].NumInterior;
                        }
                        if (data[b].EntreCalles.length > 0) {
                            direccion += ",  <strong>Entre calles: </strong> " + data[b].EntreCalles;
                        }
                        if (data[b].Referencias.length > 0) {
                            direccion += ",  <strong>Referencias: </strong> " + data[b].Referencias;
                        }


                        DireccionesCliente +=
                            "<div class='d-flex'>" +
                                "<div class='avatar avatar-online'>";
                                    if (data[b].FiscalEntrega == 1) {
                                        DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-info'>F</span>";
                                    } else {
                                        DireccionesCliente += "<span class='avatar-title rounded-circle border border-white bg-secondary'>E</span>";
                                    }
                        DireccionesCliente +=
                                "</div>" +
                                "<div class='flex-1 ml-3 pt-1'>";
                                    if (data[b].FiscalEntrega == 1) {
                                        DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-warning pl-3'>Fiscal</span></h6>";
                                    } else {
                                        DireccionesCliente += "<h6 class='text-uppercase fw-bold mb-1'>"+ data[b].Estado +" <span class='text-success pl-3'>Entrega</span></h6>";
                                    }
                        DireccionesCliente +=
                                    "<span class='text-muted'>" + direccion + "</span>"+
                                "</div>"+
                                "<div class='float-right pt-1'>";
                                    if (data[b].Select == 1) {
                        DireccionesCliente +=
                                        "<button type='button' class='btn btn-icon btn-round btn-success' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                            "<i class='fa fa-check'></i>" +
                                        "</button>";
                                    } else {
                        DireccionesCliente +=
                                        "<button type='button' class='btn btn-icon btn-default btn-round' onclick='SeleccionarDireccion(" + data[b].Id + ");'>" +
                                            "<i class='fa fa-times'></i>" +
                                        "</button>";
                                    }
                        DireccionesCliente +=
                                "</div>"+
                            "</div>"+
                            "<div class='separator-dashed'></div>";
                    }

                    $("#Direcciones_Seleccionar_List_IdCliente").html(DireccionesCliente);



                } else {
                    // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
                    $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
                    $("#Categoria_DireccionesEntrega").text("");
                    $("#SeleccionarDireccionEntrega").text("Cancelar");
                    $("#NuevaCargaDireccion").show();
                    $("#View_List_DireccionEntrega").show();
                    $("#SeleccionarDireccionFiscal").css("display", "none");

                    $("#View_List_DireccionFiscal").css("display", "none");
                    $("#Agregar_DireccionFiscal").show();
                    $("#Form_DireccionFiscal").show();
                }

	        },
	        error: function() {
                $.notify({
                message: "Inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });
    }

    $(document).ready(function () {
        $('#AgregarDirecciones').click(function () {
            $("#View_List_DireccionesView_List_Direcciones").css("display", "none");
            $("#NuevaDireccionFiscal").prop("checked", true);

            // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
            $("#Categoria_Direcciones").text("Registra la dirección fiscal del cliente, si la dirección fiscal no es la misma dirección de entrega, agrega una nueva dirección.");
            $("#Categoria_DireccionesEntrega").text("");
            $("#SeleccionarDireccionEntrega").text("Cancelar");
            $("#NuevaCargaDireccion").show();
            $("#View_List_DireccionEntrega").show();
            $("#SeleccionarDireccionFiscal").show();

            $("#View_List_DireccionFiscal").css("display", "none");
            $("#Agregar_DireccionFiscal").show();
            $("#Form_DireccionFiscal").show();
        });
    });

    $(document).ready(function () {
        $('#SeleccionarDireccionFiscal').click(function () {
            $("#NuevaDireccionFiscal").prop("checked", false);

            $("#View_List_DireccionesView_List_Direcciones").show();
            $("#View_List_DireccionEntrega").css("display", "none");

            $("#Agregar_DireccionFiscal").css("display", "none");
            $("#Agregar_DireccionEntrega").css("display", "none");

            $("#Form_DireccionFiscal").css("display", "none");
            $("#Form_DireccionEntrega").css("display", "none");

            // CARGAR DIRECCION SIN POSISBILIDAD DE SELECIONAR
            $("#Categoria_Direcciones").text("Selecciona la dirección donde se realizará la entrega.");
        });
    });



    $(document).ready(function () {
        $('#AgregarDireccionEntrega').click(function () {
            $("#NuevaDireccionEntrega").prop("checked", true);
            $("#View_List_DireccionEntrega").css("display", "none");
            $("#Agregar_DireccionEntrega").show();
            $("#Form_DireccionEntrega").show();

        });
    });

    $(document).ready(function () {
        $('#SeleccionarDireccionEntrega').click(function () {
            $("#SeleccionarDireccionEntrega").prop("checked", false);
            $("#View_List_DireccionEntrega").show();
            $("#Agregar_DireccionEntrega").css("display", "none");
            $("#Form_DireccionEntrega").css("display", "none");
        });
    });

     $(document).on('change', '#Select_CP2', function (event) {
        var Id = $("#Select_CP2 option:selected").val();
        if (Id > 0) {

            $('#Select_CP2').css("border", "1px solid #c2c2c2");
        }
    });

    $(document).on('change', '#Select_Colonia2', function (event) {
        var IdColonia = $("#Select_Colonia2 option:selected").val();

        if (IdColonia > 0) {

            $('#Select_Colonia2').css("border", "1px solid #c2c2c2");

            var obj = {};
            obj['Id'] = IdColonia;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_CP", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultadoEntrega3,
                error: errores
            });
        }
    });

    function resultadoEntrega3(data) {
        console.log(data);

        $("#Select_CP2").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_CP2").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_CP2").append(option);
            });
        }
    }

    $(document).on('change', '#Select_Delegacion_Municipio2', function (event) {
        var IdPoblacion = $("#Select_Delegacion_Municipio2 option:selected").val();

        if (IdPoblacion > 0) {

            $('#Select_Delegacion_Municipio2').css("border", "1px solid #c2c2c2");

            $("#Select_CP2").empty();

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_CP2").append(option);

            var obj = {};
            obj['Id'] = IdPoblacion;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_Colonias", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultadoEntrega2,
                error: errores
            });

        }
    });

    function resultadoEntrega2(data) {

        $("#Select_Colonia2").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_Colonia2").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_Colonia2").append(option);
            });
        }
    }

    $(document).on('change', '#Select_DEstado2', function (event) {
        var IdPoblacion = $("#Select_DEstado2 option:selected").val();

        if (IdPoblacion > 0) {
            $("#Busqueda_CP2").css("display", "none");
            $("#Select_DivDelegacionMunicipio2").show();
            $("#Select_DivColonia2").show();
            $("#Select_DivCP2").show();
            $("#Select_DivNumExterior2").show();
            $("#Select_DivNumInterior2").show();
            $("#Select_DivCalle2").show();
            $("#Select_DivEntreCalles2").show();
            $("#Select_DivReferencias2").show();
            $("#Btn_DivBusqueda2").show();

            $('#Select_DEstado2').css("border", "1px solid #c2c2c2");

            $("#Select_Colonia2").empty();
            $("#Select_CP2").empty();

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            var option2 = $(document.createElement('option'));
            option2.text("Seleccionar");
            option2.val(0);

            $("#Select_Colonia2").append(option);
            $("#Select_CP2").append(option2);


            var obj = {};
            obj['Id'] = IdPoblacion;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_DelegacionMunicipio", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultadoEntrega,
                error: errores
            });

        } else {
            $("#Busqueda_CP2").show();
            $("#Select_DivDelegacionMunicipio2").css("display", "none");
            $("#Select_DivColonia2").css("display", "none");
            $("#Select_DivCP2").css("display", "none");
            $("#Select_DivNumExterior2").css("display", "none");
            $("#Select_DivNumInterior2").css("display", "none");
            $("#Select_DivCalle2").css("display", "none");
            $("#Select_DivEntreCalles2").css("display", "none");
            $("#Select_DivReferencias2").css("display", "none");
            $("#Btn_DivBusqueda2").css("display", "none");
        }

    });

    function resultadoEntrega(data) {
        console.log(data);

        $("#Select_Delegacion_Municipio2").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_Delegacion_Municipio2").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_Delegacion_Municipio2").append(option);
            });
        }
    }

    $('#BtnBuscar2').click(function () {

        $('#CP_Fiscal2').css("border", "2px solid #f44336");

        if ($('#CP_Fiscal2').val().length > 0) {
            $('#CP_Fiscal2').css("border", "1px solid #c2c2c2");
        }

        var CP = $("#CP_Fiscal2").val();

        if (CP.length > 0) {

            var obj = {};
            obj['Nombre'] = CP;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("CP_Busqueda", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultadoBusqueda2,
                error: errores
            });


        } else {
            $('#CP_Fiscal2').css("border", "2px solid #f44336");
            $.notify({
                message: "Coloca el código postal que buscas."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    });

    function resultadoBusqueda2(data) {
        if (data.length > 0) {

            console.log(data);

            $('#Select_DEstado2 option[value="'+ data[0]["IdEstado"] +'"]').attr("selected", true);


            var IdPoblacion = $("#Select_DEstado2 option:selected").val();

            if (IdPoblacion > 0) {
                $("#Busqueda_CP2").css("display", "none");
                $("#Select_DivDelegacionMunicipio2").show();
                $("#Select_DivColonia2").show();
                $("#Select_DivCP2").show();
                $("#Select_DivNumExterior2").show();
                $("#Select_DivNumInterior2").show();
                $("#Select_DivCalle2").show();
                $("#Select_DivEntreCalles2").show();
                $("#Select_DivReferencias2").show();
                $("#Btn_DivBusqueda2").show();

                var obj = {};
                obj['Id'] = IdPoblacion;

                var jsonObject = {
                    "Catalogos": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Consulta_DelegacionMunicipio", "Clientes")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (result) {

                        $("#Select_Delegacion_Municipio2").empty();

                        if (result.length > 0) {

                            var option = $(document.createElement('option'));
                            option.text("Seleccionar");
                            option.val(0);

                            $("#Select_Delegacion_Municipio2").append(option);

                            $(result).each(function () {
                                var option = $(document.createElement('option'));

                                option.text(this.Nombre);
                                option.val(this.Id);

                                $("#Select_Delegacion_Municipio2").append(option);
                            });
                        }
                        $('#Select_Delegacion_Municipio2 option[value="' + data[0]["IdPoblacion"] + '"]').attr("selected", true);


                        $("#Select_Colonia2").empty();

                        if (data.length > 0) {

                            var option = $(document.createElement('option'));
                            option.text("Seleccionar");
                            option.val(0);

                            $("#Select_Colonia2").append(option);

                            $(data).each(function () {
                                var option = $(document.createElement('option'));

                                option.text(this.Colonia);
                                option.val(this.IdCP);

                                $("#Select_Colonia2").append(option);
                            });
                        }

                        $('#Select_Colonia2 option[value="' + data[0]["IdCP"] + '"]').attr("selected", true);

                        $("#Select_CP2").empty();

                        var option = $(document.createElement('option'));
                        option.text(data[0]["CP"]);
                        option.val(data[0]["IdCP"]);

                        $("#Select_CP2").append(option);

                    }
                });

            } else {
                $("#Busqueda_CP2").show();
                $("#Select_DivDelegacionMunicipio2").css("display", "none");
                $("#Select_DivColonia2").css("display", "none");
                $("#Select_DivCP2").css("display", "none");
                $("#Select_DivNumExterior2").css("display", "none");
                $("#Select_DivNumInterior2").css("display", "none");
                $("#Select_DivCalle2").css("display", "none");
                $("#Select_DivEntreCalles2").css("display", "none");
                $("#Select_DivReferencias2").css("display", "none");
                $("#Btn_DivBusqueda2").css("display", "none");
            }

        } else {
            $.notify({
                message: "Código postal no encontrado."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    }

    $('#BtnBuscarCP2').click(function () {
        $("#Busqueda_CP2").show();
        $("#Select_DivDelegacionMunicipio2").css("display", "none");
        $("#Select_DivColonia2").css("display", "none");
        $("#Select_DivCP2").css("display", "none");
        $("#Select_DivNumExterior2").css("display", "none");
        $("#Select_DivNumInterior2").css("display", "none");
        $("#Select_DivCalle2").css("display", "none");
        $("#Select_DivEntreCalles2").css("display", "none");
        $("#Select_DivReferencias2").css("display", "none");
        $("#Btn_DivBusqueda2").css("display", "none");
    });


    $(document).ready(function () {
        $('#AgregarDireccionFiscal').click(function () {
            $("#View_List_DireccionFiscal").css("display", "none");
            $("#Agregar_DireccionFiscal").show();
            $("#Form_DireccionFiscal").show();
        });
    });


    $(document).on('change', '#Select_CP', function (event) {
        var Id = $("#Select_CP option:selected").val();
        if (Id > 0) {

            $('#Select_CP').css("border", "1px solid #c2c2c2");
        }
    });

    $(document).on('change', '#Select_Colonia', function (event) {
        var IdColonia = $("#Select_Colonia option:selected").val();

        if (IdColonia > 0) {

            $('#Select_Colonia').css("border", "1px solid #c2c2c2");

            var obj = {};
            obj['Id'] = IdColonia;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_CP", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultado3,
                error: errores
            });
        }
    });

    function resultado3(data) {
        console.log(data);

        $("#Select_CP").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_CP").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_CP").append(option);
            });
        }
    }

    $(document).on('change', '#Select_Delegacion_Municipio', function (event) {
        var IdPoblacion = $("#Select_Delegacion_Municipio option:selected").val();

        if (IdPoblacion > 0) {

            $('#Select_Delegacion_Municipio').css("border", "1px solid #c2c2c2");

            $("#Select_CP").empty();

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_CP").append(option);



            var obj = {};
            obj['Id'] = IdPoblacion;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_Colonias", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultado2,
                error: errores
            });

        }
    });

    function resultado2(data) {

        $("#Select_Colonia").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_Colonia").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_Colonia").append(option);
            });
        }
    }

    $(document).on('change', '#Select_DEstado', function (event) {
        var IdPoblacion = $("#Select_DEstado option:selected").val();

        if (IdPoblacion > 0) {
            $("#Busqueda_CP").css("display", "none");
            $("#Select_DivDelegacionMunicipio").show();
            $("#Select_DivColonia").show();
            $("#Select_DivCP").show();
            $("#Select_DivNumExterior").show();
            $("#Select_DivNumInterior").show();
            $("#Select_DivCalle").show();
            $("#Select_DivEntreCalles").show();
            $("#Select_DivReferencias").show();
            $("#Btn_DivBusqueda").show();

            $('#Select_DEstado').css("border", "1px solid #c2c2c2");

            $("#Select_Colonia").empty();
            $("#Select_CP").empty();

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            var option2 = $(document.createElement('option'));
            option2.text("Seleccionar");
            option2.val(0);

            $("#Select_Colonia").append(option);
            $("#Select_CP").append(option2);


            var obj = {};
            obj['Id'] = IdPoblacion;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Consulta_DelegacionMunicipio", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultado,
                error: errores
            });

        } else {
            $("#Busqueda_CP").show();
            $("#Select_DivDelegacionMunicipio").css("display", "none");
            $("#Select_DivColonia").css("display", "none");
            $("#Select_DivCP").css("display", "none");
            $("#Select_DivNumExterior").css("display", "none");
            $("#Select_DivNumInterior").css("display", "none");
            $("#Select_DivCalle").css("display", "none");
            $("#Select_DivEntreCalles").css("display", "none");
            $("#Select_DivReferencias").css("display", "none");
            $("#Btn_DivBusqueda").css("display", "none");
        }

    });

    function resultado(data) {
        console.log(data);

        $("#Select_Delegacion_Municipio").empty();

        if (data.length > 0) {

            var option = $(document.createElement('option'));
            option.text("Seleccionar");
            option.val(0);

            $("#Select_Delegacion_Municipio").append(option);

            $(data).each(function () {
                var option = $(document.createElement('option'));

                option.text(this.Nombre);
                option.val(this.Id);

                $("#Select_Delegacion_Municipio").append(option);
            });
        }
    }


    $('#BtnBuscarCP').click(function () {
        $("#Busqueda_CP").show();
        $("#Select_DivDelegacionMunicipio").css("display", "none");
        $("#Select_DivColonia").css("display", "none");
        $("#Select_DivCP").css("display", "none");
        $("#Select_DivNumExterior").css("display", "none");
        $("#Select_DivNumInterior").css("display", "none");
        $("#Select_DivCalle").css("display", "none");
        $("#Select_DivEntreCalles").css("display", "none");
        $("#Select_DivReferencias").css("display", "none");
        $("#Btn_DivBusqueda").css("display", "none");
    });

    $('#BtnBuscar').click(function () {

        $('#CP_Fiscal').css("border", "2px solid #f44336");

        if ($('#CP_Fiscal').val().length > 0) {
            $('#CP_Fiscal').css("border", "1px solid #c2c2c2");
        }

        var CP = $("#CP_Fiscal").val();

        if (CP.length > 0) {

            var obj = {};
            obj['Nombre'] = CP;

            var jsonObject = {
                "Catalogos": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("CP_Busqueda", "Clientes")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: resultadoBusqueda,
                error: errores
            });


        } else {
            $('#CP_Fiscal').css("border", "2px solid #f44336");
            $.notify({
                message: "Coloca el código postal que buscas."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    });

    function resultadoBusqueda(data) {
        if (data.length > 0) {

            console.log(data);

            $('#Select_DEstado option[value="'+ data[0]["IdEstado"] +'"]').attr("selected", true);


            var IdPoblacion = $("#Select_DEstado option:selected").val();

            if (IdPoblacion > 0) {
                $("#Busqueda_CP").css("display", "none");
                $("#Select_DivDelegacionMunicipio").show();
                $("#Select_DivColonia").show();
                $("#Select_DivCP").show();
                $("#Select_DivNumExterior").show();
                $("#Select_DivNumInterior").show();
                $("#Select_DivCalle").show();
                $("#Select_DivEntreCalles").show();
                $("#Select_DivReferencias").show();
                $("#Btn_DivBusqueda").show();

                var obj = {};
                obj['Id'] = IdPoblacion;

                var jsonObject = {
                    "Catalogos": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Consulta_DelegacionMunicipio", "Clientes")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (result) {

                        $("#Select_Delegacion_Municipio").empty();

                        if (result.length > 0) {

                            var option = $(document.createElement('option'));
                            option.text("Seleccionar");
                            option.val(0);

                            $("#Select_Delegacion_Municipio").append(option);

                            $(result).each(function () {
                                var option = $(document.createElement('option'));

                                option.text(this.Nombre);
                                option.val(this.Id);

                                $("#Select_Delegacion_Municipio").append(option);
                            });
                        }
                        $('#Select_Delegacion_Municipio option[value="' + data[0]["IdPoblacion"] + '"]').attr("selected", true);


                        $("#Select_Colonia").empty();

                        if (data.length > 0) {

                            var option = $(document.createElement('option'));
                            option.text("Seleccionar");
                            option.val(0);

                            $("#Select_Colonia").append(option);

                            $(data).each(function () {
                                var option = $(document.createElement('option'));

                                option.text(this.Colonia);
                                option.val(this.IdCP);

                                $("#Select_Colonia").append(option);
                            });
                        }

                        $('#Select_Colonia option[value="' + data[0]["IdCP"] + '"]').attr("selected", true);

                        $("#Select_CP").empty();

                        var option = $(document.createElement('option'));
                        option.text(data[0]["CP"]);
                        option.val(data[0]["IdCP"]);

                        $("#Select_CP").append(option);

                    }
                });

            } else {
                $("#Busqueda_CP").show();
                $("#Select_DivDelegacionMunicipio").css("display", "none");
                $("#Select_DivColonia").css("display", "none");
                $("#Select_DivCP").css("display", "none");
                $("#Select_DivNumExterior").css("display", "none");
                $("#Select_DivNumInterior").css("display", "none");
                $("#Select_DivCalle").css("display", "none");
                $("#Select_DivEntreCalles").css("display", "none");
                $("#Select_DivReferencias").css("display", "none");
                $("#Btn_DivBusqueda").css("display", "none");
            }

        } else {
            $.notify({
                message: "Código postal no encontrado."
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }
    }

    function errores(data) {
       $.notify({
        title: 'Se ha presentado un problema #18595',
        },{
        type: 'danger',
            time: 1000,
        });
    }

    function VerArticulo(num)
    {
        var IdProducto = num;

        var obj = {};

        obj['Id'] = IdProducto;

        var jsonObject = {
            "Producto": obj
        };

        // LIMPIA DATOS
        $("#SP_Nombre").text("");
        $("#SP_SKU").text("");
        $("#SP_Categoria").text("");
        $("#SP_Descripcion").text("");
        $("#SP_Distribuidor").text("");
        $("#SP_Publico").text("");
        $("#SP_Demo").text("");
        $("#SP_PromocionArticulo").text("");
        $("#DivImg").html("");

        $.ajax({
            type: "POST",
            url: "@Url.Action("Producto_Seleccionar_Id", "Productos")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: Resultado2,
            error: Errores2
        });
    }

    //SELECTS TABLAS
    function EliminarArticulo(num)
    {
        var obj = {};
        obj['IdProducto'] = num;

        var jsonObject = {
            "VentaProducto": obj
        };
        $.ajax({
            type: "POST",
            url: "@Url.Action("EliminarProducto", "Ventas")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                    console.log(respuesta);


                    $("#Table_Articulos > tbody").empty();

                    var htmlTags = '';
                    for (var b = 0; b < respuesta.length; b++) {
                        htmlTags += '' +
                            '<tr>' +
                                '<th>' + respuesta[b].Producto.Nombre + ' <br /><strong>SKU:</strong> ' + respuesta[b].Producto.SKU + ' </th>'+
                                '<td>' +
                                    '<div class="col-md-12 col-lg-12" >'+
                                        '<input type="number" class="form-control" value="'+ respuesta[b].Cantidad + '" id="InputCantidad_' + respuesta[b].IdProducto + '" onchange="ActualizarCantidad('+respuesta[b].IdProducto+');">'+
                                    '</div>'+
                                '</td>' +
                                '<td>'+
                                    '<div class="col-md-12 col-lg-12">' +
                                        '<select disabled class="form-control precio-selector" id="SelectPrecio_'+respuesta[b].IdProducto+'"  style="width:100%" onchange="ActualizarCat_Precio('+respuesta[b].IdProducto+');">';

                                        for (var c = 0; c < respuesta[b].CatPrecios.length; c++) {

                                            if (respuesta[b].IdCatPrecios == respuesta[b].CatPrecios[c].Id) {
                                                htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '" selected>' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                            } else {
                                                htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '">' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                            }
                                        }

                            htmlTags += '</select>'+
                                    '</div>'+
                                '</td>' +
                                '<td>' +
                                    '<div class="col-md-12 col-lg-12" >';

                                        if (respuesta[b].IdCatPrecios == 5) {
                                            htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')">';
                                        } else {
                                            htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')" disabled>';
                                        }
                            htmlTags += '</div>'+
                                '</td>' +
                                '<td class="text-center subtotal">' +
                                    '<strong><p Id="PTotal_' + respuesta[b].IdProducto + '"> ' + (respuesta[b].Precio * respuesta[b].Cantidad) + ' </p><strong>' +
                                '</td>' +
                                '<td>' +
                                    '<div class="row">' +
                                        '<div class="col-md-2 col-lg-2">' +
                                            '<button type="button" class="btn btn-icon btn-round btn-default" onclick="EliminarArticulo(' + respuesta[b].IdProducto + ');">' +
                                                '<i class="fa fa-trash"></i>' +
                                            '</button>' +
                                        '</div>' +
                                        '<div class="col-md-2 col-lg-2">' +
                                            '<button type="button" class="btn btn-icon btn-round btn-default"  onclick="VerArticulo(' + respuesta[b].IdProducto + ');">' +
                                                    '<i class="fa fa-eye"></i>' +
                                                '</button>' +
                                        '</div>' +
                                        '<div class="col-md-6 col-lg-6">' +

                                            '<div class="form-check">' +
                                                '<label class="form-check-label">';
                                                    if (respuesta[b].BackOrder == 1) {
                                                        htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');" checked>';
                                                    } else {
                                                        htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');">';
                                                    }
                                htmlTags +=          '<span class="form-check-sign">Back Order</span>' +
                                                '</label>' +
                                            '</div>' +
                                        '</div>' +
                                    '</div>' +
                                '</td>' +
                            '</tr>';
                    }
                    $('#Table_Articulos tbody').append(htmlTags);

                    SumaTotalArticulos();

                    $.notify({
                        message: "Producto eliminado"
                    }, {
                        type: 'primary',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });

	        },
	        error: function() {
                $.notify({
                message: "Producto no registrado, inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });
    }

    function ActualizarBackOrder(num) {
        var BackOrder = 0;
        if ($('#BackOrder_' + num).prop('checked')) {
            BackOrder = 1;
        }

        var obj = {};

        obj['IdProducto'] = num;
        obj['BackOrder'] = BackOrder;

        var jsonObject = {
            "VentaProducto": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("ActualizarBackOrder", "Ventas")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {

                if (respuesta.BackOrder == 1) {
                     $.notify({
                        message: "Producto en Back Order"
                    }, {
                        type: 'primary',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                }


            },
            error: function () {
                $.notify({
                    message: "Back Order no registrado, inténtelo mas tarde."
                }, {
                    type: 'danger',
                    allow_dismiss: false,
                    animate: {
                        enter: 'animated rollIn',
                        exit: 'animated rollOut'
                    }
                });
            }
        });
    }

    function ActulizarPrecio(num)
    {
        var Precio  = $("#InputPrecio_" + num).val();
        var cantidad = $("#InputCantidad_" + num).val();

        var obj = {};
        obj['IdProducto'] = num;
        obj['Precio'] = Precio;

        var jsonObject = {
            "VentaProducto": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("ActulizarPrecio", "Ventas")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                console.log(respuesta);

                var Precio  = $("#InputPrecio_" + num).val();
                var cantidad = $("#InputCantidad_" + num).val();

                $("#PTotal_" + num).text(cantidad * Precio);
                SumaTotalArticulos();
            },
            error: function () {
                $.notify({
                    message: "Cantidad no agregada, inténtelo mas tarde."
                }, {
                    type: 'danger',
                    allow_dismiss: false,
                    animate: {
                        enter: 'animated rollIn',
                        exit: 'animated rollOut'
                    }
                });
            }
        });


    }

    function ActualizarCantidad(num)
    {
        var cantidad = $("#InputCantidad_" + num).val();
        var obj = {};
        obj['IdProducto'] = num;
        obj['Cantidad'] = cantidad;

        var jsonObject = {
            "VentaProducto": obj
        };

        $.ajax({
                type: "POST",
                url: "@Url.Action("ActulizarCantidad", "Ventas")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (respuesta) {
                    console.log(respuesta);

                    var cantidad = $("#InputCantidad_" + num).val();
                    var Precio  = $("#InputPrecio_" + num).val();

                    $("#PTotal_" + num).text(cantidad * Precio);

                    SumaTotalArticulos();
                },
                error: function () {
                    $.notify({
                        message: "Cantidad no agregada, inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                }
            });


    }

    //SELECTS TABLAS
    function ActualizarCat_Precio(num) {
        var IdCatPrecios = $("#SelectPrecio_"+num+" option:selected").val();

        if (IdCatPrecios == 5) {
            $("#InputPrecio_" + num).prop("disabled", false);


        } else {
            $("#InputPrecio_"+num).prop("disabled", true);
        }

            var obj = {};
            obj['IdProducto'] = num;
            obj['IdPrecio'] = IdCatPrecios;

            var jsonObject = {
                "VentaProducto": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("ConsultaPrecio", "Ventas")",
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (respuesta) {
                    console.log(respuesta);

                    var cantidad = $("#InputCantidad_" + num).val();
                    $("#InputPrecio_" + num).val(respuesta.Precio);


                    $("#PTotal_" + num).text(cantidad * respuesta.Precio);

                    SumaTotalArticulos();
                },
                error: function () {
                    $.notify({
                        message: "Precio no encontrado, inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                }
            });

    }

    function SumaTotalArticulos() {
        var sum = 0;
        $('.subtotal').each(function () {
            sum += parseFloat($(this).text().replace(/,/g, ''), 10);
        });
        var formatter = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 2, maximumFractionDigits: 2 });
        var formattedSum = formatter.format(parseFloat(sum));
        $('#resultado_total').text(formattedSum);
        $('#resultado_total2').text(formattedSum);
        $('#resultado_total3').text(formattedSum);


        //$('#resultado_total').text(sum.toFixed(2).toLocaleString());
        //$('#resultado_total2').text(sum.toFixed(2).toLocaleString());
        //$('#resultado_total3').text(sum.toFixed(2).toLocaleString());
    }



    //AL REGISTRAR UN NUEVO PRODUCTO
    $(document).ready(function () {

        $('#BtnRegistrarProducto').click(function () {


            $('#Cantidad').css("border", "2px solid #f44336");
            var IdProducto = $("#basic2 option:selected").val();

            if (IdProducto > 0) {

               //////////////////////////////////////////
                 var obj = {};
            obj['Id'] = IdProducto;

            var jsonObject = {
                "data": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("Taller", "Ventas")",
                async: false,
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    var esTaller = data.Id == 28;

                    if (esTaller && $('#fechatallersito').val() === "") {
                            $.notify({
                                message: "Selecciona una fecha para el taller."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                            });
                            return;
                    }

                    // Si es un taller, agregarlo a la lista de talleres
                    if (esTaller) {
                        var taller = {
                            Id: data.IdCliente,
                            Fecha: $('#fechatallersito').val()
                        };

                        // Verificar si el taller ya existe en la lista
                        var existeTaller = false;
                        for (var i = 0; i < talleres.length; i++) {
                            if (talleres[i].Id === taller.Id && talleres[i].Fecha === taller.Fecha) {
                                existeTaller = true;
                                break;
                            }
                        }

                        // Agregar el taller a la lista solo si no existe
                        if (!existeTaller) {
                            talleres.push(taller);
                            sessionStorage.setItem('talleres', JSON.stringify(talleres));
                        } else {
                            // Mostrar una notificación o mensaje indicando que el taller ya ha sido seleccionado
                            $.notify({
                                message: "El taller ya ha sido seleccionado previamente."
                            }, {
                                type: 'warning',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                            });
                        }
                    }

                        // Resto de la lógica de registro del producto
                        if ($('#Cantidad').val() > 0) {
                        $('#Cantidad').css("border", "1px solid #c2c2c2");

                        var IdProducto = $("#basic2 option:selected").val();

                        var obj = {};
                        obj['IdProducto'] = IdProducto;
                        obj['Cantidad'] = $('#Cantidad').val();

                        var jsonObject = {
                            "VentaProducto": obj
                        };


                        $.ajax({
                        type: "POST",
                        url: "@Url.Action("AgregarProducto", "Ventas")",
                        data: JSON.stringify(jsonObject),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (respuesta) {

                                if (respuesta.length > 0) {
                                    $("#Table_Articulos > tbody").empty();

                                    var htmlTags = '';
                                    for (var b = 0; b < respuesta.length; b++) {
                                        htmlTags += '' +
                                            '<tr>' +
                                                '<th>' + respuesta[b].Producto.Nombre + ' <br /><strong>SKU:</strong> ' + respuesta[b].Producto.SKU + ' </th>'+
                                                '<td>' +
                                                    '<div class="col-md-12 col-lg-12" >'+
                                                        '<input type="number" class="form-control" value="'+ respuesta[b].Cantidad + '" id="InputCantidad_' + respuesta[b].IdProducto + '" onchange="ActualizarCantidad('+respuesta[b].IdProducto+');">'+
                                                    '</div>'+
                                                '</td>' +
                                                '<td>'+
                                                    '<div class="col-md-12 col-lg-12">' +
                                                        '<select disabled class="form-control precio-selector" id="SelectPrecio_'+respuesta[b].IdProducto+'" style="width:100%" onchange="ActualizarCat_Precio('+respuesta[b].IdProducto+');">';

                                                        for (var c = 0; c < respuesta[b].CatPrecios.length; c++) {

                                                            if (respuesta[b].IdCatPrecios == respuesta[b].CatPrecios[c].Id) {
                                                                htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '" selected>' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                                            } else {
                                                                htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '">' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                                            }
                                                        }

                                            htmlTags += '</select>'+
                                                    '</div>'+
                                                '</td>' +
                                                '<td>' +
                                                    '<div class="col-md-12 col-lg-12" >';

                                                        if (respuesta[b].IdCatPrecios == 5) {
                                                            htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')">';
                                                        } else {
                                                            htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')" disabled>';
                                                        }
                                          htmlTags += '</div>'+
                                                '</td>' +
                                                '<td class="text-center subtotal">' +
                                                    '<strong><p Id="PTotal_' + respuesta[b].IdProducto + '"> ' + (respuesta[b].Precio * respuesta[b].Cantidad) + ' </p><strong>' +
                                                '</td>' +
                                                '<td>' +
                                                    '<div class="row">' +
                                                        '<div class="col-md-2 col-lg-2">' +
                                                            '<button type="button" class="btn btn-icon btn-round btn-default" onclick="EliminarArticulo(' + respuesta[b].IdProducto + ');">' +
                                                                '<i class="fa fa-trash"></i>' +
                                                            '</button>' +
                                                        '</div>' +
                                                        '<div class="col-md-2 col-lg-2">' +
                                                            '<button type="button" class="btn btn-icon btn-round btn-default"  onclick="VerArticulo(' + respuesta[b].IdProducto + ');">' +
                                                                '<i class="fa fa-eye"></i>' +
                                                            '</button>' +
                                                        '</div>' +
                                                        '<div class="col-md-6 col-lg-6">' +

                                                            '<div class="form-check">' +
                                                                '<label class="form-check-label">';
                                                                    if (respuesta[b].BackOrder == 1) {
                                                                        htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');" checked>';
                                                                    } else {
                                                                        htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');">';
                                                                    }
                                               htmlTags +=          '<span class="form-check-sign">Back Order</span>' +
                                                                '</label>' +
                                                            '</div>' +
                                                        '</div>' +
                                                    '</div>' +
                                                '</td>' +
                                            '</tr>';
                                    }
                                    $('#Table_Articulos tbody').append(htmlTags);

                                    $('#Cantidad').val(0);
                                    SumaTotalArticulos();
                                }

                                //////////PRUEBASCAMBIOSPRECIOS///////////
                            Verificar2();
	                    },
	                    error: function() {
                            $.notify({
                            message: "Producto no registrado, inténtelo mas tarde."
                                }, {
                                    type: 'danger',
                                    allow_dismiss: false,
                                    animate: {
                                        enter: 'animated rollIn',
                                        exit: 'animated rollOut'
                                    }
                            });
                        }
                        });

                    }
                        else {
                    $.notify({
                        message: "Agrega la cantidad de productos."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                        }


                    },
                error: function () {
                        $.notify({
                            message: "Error al obtener información del taller."
                        }, {
                            type: 'danger',
                            allow_dismiss: false,
                            animate: {
                                enter: 'animated rollIn',
                                exit: 'animated rollOut'
                            }
                        });
                    }
                });
               //////////////////////////////////////////

            } else {
                $.notify({
                    message: "Selecciona un producto."
                }, {
                    type: 'danger',
                    allow_dismiss: false,
                    animate: {
                        enter: 'animated rollIn',
                        exit: 'animated rollOut'
                    }
                });
            }
        });
    });

    function GuardarTaller() {
        var Ctalleres = sessionStorage.getItem('talleres');
        var talleres = JSON.parse(Ctalleres); // Parsea el valor de sessionStorage si es necesario

        var obj = {};


        var jsonObject = {
            Objetotaller: talleres
        };

        $.ajax({
            url: "@Url.Action("Guardartaller", "Ventas")",
            type: 'POST',
            data: JSON.stringify(jsonObject),
            contentType: 'application/json',
            success: function (response) {
                talleres = null; // Vaciar la variable talleres después del éxito
                sessionStorage.setItem('talleres', JSON.stringify(talleres)); // Actualizar el valor en sessionStorage
            },
            error: function (error) {
                alert("Error");
            }
        });
    }


    //SE CONSULTA LA SESION DE PRODUCTOS
    $(document).ready(function () {
        $.ajax({
            type: "POST",
            url: "@Url.Action("ConsultaProductosAgregados", "Ventas")",
            data: '',//JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                    console.log(respuesta);

                    if (respuesta.length > 0) {
                        $("#Table_Articulos > tbody").empty();

                        var htmlTags = '';
                        for (var b = 0; b < respuesta.length; b++) {
                            htmlTags += '' +
                                '<tr>' +
                                    '<th>' + respuesta[b].Producto.Nombre + ' <br /><strong>SKU:</strong> ' + respuesta[b].Producto.SKU + ' </th>'+
                                    '<td>' +
                                        '<div class="col-md-12 col-lg-12" >'+
                                            '<input type="number" class="form-control" value="'+ respuesta[b].Cantidad + '" id="InputCantidad_' + respuesta[b].IdProducto + '" onchange="ActualizarCantidad('+respuesta[b].IdProducto+');">'+
                                        '</div>'+
                                    '</td>' +
                                    '<td>'+
                                        '<div class="col-md-12 col-lg-12">' +
                                            '<select disabled class="form-control precio-selector" id="SelectPrecio_'+respuesta[b].IdProducto+'" style="width:100%" onchange="ActualizarCat_Precio('+respuesta[b].IdProducto+');">';

                                            for (var c = 0; c < respuesta[b].CatPrecios.length; c++) {

                                                if (respuesta[b].IdCatPrecios == respuesta[b].CatPrecios[c].Id) {
                                                    htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '" selected>' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                                } else {
                                                    htmlTags += '<option value="' + respuesta[b].CatPrecios[c].Id + '">' + respuesta[b].CatPrecios[c].Nombre + '</option>';
                                                }
                                            }

                                htmlTags += '</select>'+
                                        '</div>'+
                                    '</td>' +
                                    '<td>' +
                                        '<div class="col-md-12 col-lg-12" >';

                                            if (respuesta[b].IdCatPrecios == 5) {
                                                htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')">';
                                            } else {
                                                htmlTags += '<input type="text" class="form-control input-number" value="' + respuesta[b].Precio + '" id="InputPrecio_' + respuesta[b].IdProducto + '" onchange="ActulizarPrecio('+respuesta[b].IdProducto+')" disabled>';
                                            }
                                htmlTags += '</div>'+
                                    '</td>' +
                                    '<td class="text-center subtotal">' +
                                        '<strong><p Id="PTotal_' + respuesta[b].IdProducto + '"> ' + (respuesta[b].Precio * respuesta[b].Cantidad) + ' </p><strong>' +
                                    '</td>' +
                                    '<td>' +
                                        '<div class="row">' +
                                            '<div class="col-md-2 col-lg-2">' +
                                                '<button type="button" class="btn btn-icon btn-round btn-default" onclick="EliminarArticulo(' + respuesta[b].IdProducto + ');">' +
                                                    '<i class="fa fa-trash"></i>' +
                                                '</button>' +
                                            '</div>' +
                                            '<div class="col-md-2 col-lg-2">' +
                                                '<button type="button" class="btn btn-icon btn-round btn-default"  onclick="VerArticulo(' + respuesta[b].IdProducto + ');">' +
                                                    '<i class="fa fa-eye"></i>' +
                                                '</button>' +
                                            '</div>' +
                                            '<div class="col-md-6 col-lg-6">' +

                                                '<div class="form-check">' +
                                                    '<label class="form-check-label">';
                                                        if (respuesta[b].BackOrder == 1) {
                                                            htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');" checked>';
                                                        } else {
                                                            htmlTags += '<input id="BackOrder_' + respuesta[b].IdProducto + '" name="BackOrder" class="form-check-input" type="checkbox" onclick="ActualizarBackOrder(' + respuesta[b].IdProducto + ');">';
                                                        }
                                    htmlTags +=          '<span class="form-check-sign">Back Order</span>' +
                                                    '</label>' +
                                                '</div>' +
                                            '</div>' +
                                        '</div>' +
                                    '</td>' +
                                '</tr>';
                        }
                        $('#Table_Articulos tbody').append(htmlTags);

                        $('#Cantidad').val(0);
                        SumaTotalArticulos();
                    }
	        },
	        error: function() {
                $.notify({
                message: "Producto no registrado, inténtelo mas tarde."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });
    });


    $(document).on('change', '#Select_Persona', function (event) {
        var persona = $("#Select_Persona option:selected").val();

        if (persona == 1) {
            $("#Fisica_Div1").show();
            $("#Fisica_Div2").show();

            $("#Moral_Div1").css("display", "none");
            $("#Moral_Div2").css("display", "none");

        } else if (persona == 2) {
            $("#Fisica_Div1").css("display", "none");
            $("#Fisica_Div2").css("display", "none");

            $("#Moral_Div1").show();
            $("#Moral_Div2").show();

        } else {
            $("#Fisica_Div1").css("display", "none");
            $("#Fisica_Div2").css("display", "none");

            $("#Moral_Div1").css("display", "none");
            $("#Moral_Div2").css("display", "none");
        }
        if ($("#Select_Persona option:selected").val() > 0) {
            $('#Select_Persona').css("border", "1px solid #c2c2c2");
        }
    });

    $("#datepicker").datepicker({
        uiLibrary: 'bootstrap4',
        format: 'yyyy-mm-dd',

    });

    $('#datepicker2').datepicker({
        uiLibrary: 'bootstrap4',
        format: 'yyyy-mm-dd',
    });

</script>

<script>
    $(document).ready(function () {
        $('#Btn_BuscarCliente').click(function () {

            $("#NuevoCliente").prop("checked", false);

            $("#div_InfoCliente").show();
            $("#Card_Cliente_Title").show();
            $("#div_NuevoCliente").css("display", "none");
            $("#Card_NuevoCliente_Title").css("display", "none");
            $("#Card_NuevoCliente_Categoria").css("display", "none");

            $("#Card_NuevoCliente_Datos").css("display", "none");
            $("#row_TipoCliente").css("display", "none");

            $("#hr_Separador").css("display", "none");
            $("#Card_NuevoCliente_Contacto").css("display", "none");
            $("#row_Contacto").css("display", "none");
            $("#row_Contacto2").css("display", "none");

            $("#Fisica_Div1").css("display", "none");
            $("#Fisica_Div2").css("display", "none");

            $("#Moral_Div1").css("display", "none");
            $("#Moral_Div2").css("display", "none");

        });
    });

    $(document).ready(function () {
        $('#Btn_NuevoCliente').click(function () {

            $("#NuevoCliente").prop("checked",true);

            $("#div_InfoCliente").css("display", "none");
            $("#Card_Cliente_Title").css("display", "none");
            $("#div_NuevoCliente").show();
            $("#Card_NuevoCliente_Title").show();
            $("#Card_NuevoCliente_Categoria").show();


            $("#Card_NuevoCliente_Datos").show();
            $("#row_TipoCliente").show();

            $("#hr_Separador").show();
            $("#Card_NuevoCliente_Contacto").show();
            $("#row_Contacto").show();
            $("#row_Contacto2").show();

            var persona = $("#Select_Persona option:selected").val();

            if (persona == 1) {
                $("#Fisica_Div1").show();
                $("#Fisica_Div2").show();

                $("#Moral_Div1").css("display", "none");
                $("#Moral_Div2").css("display", "none");

            } else if (persona == 2) {
                $("#Fisica_Div1").css("display", "none");
                $("#Fisica_Div2").css("display", "none");

                $("#Moral_Div1").show();
                $("#Moral_Div2").show();

            } else {
                $("#Fisica_Div1").css("display", "none");
                $("#Fisica_Div2").css("display", "none");

                $("#Moral_Div1").css("display", "none");
                $("#Moral_Div2").css("display", "none");
            }
            if ($("#Select_Persona option:selected").val() > 0) {
                $('#Select_Persona').css("border", "1px solid #c2c2c2");
            }

        });
    });

    $(document).on('change', '#Select_FormaPago', function (event) {

        var Id = $("#Select_FormaPago option:selected").val();

        if (Id == 2) {

            $("#Div_Select_Bancos").show();
        } else {
            $("#Div_Select_Bancos").css("display", "none");
        }
    });


    $(document).ready(function () {

        $('#basic').select2({
            theme: "bootstrap"
        });

        $('#basic2').select2({
            theme: "bootstrap"
        });

        var now = new Date();
        var day = ("0" + now.getDate()).slice(-2);
        var month = ("0" + (now.getMonth() + 1)).slice(-2);

        var today = now.getFullYear() + "-" + (month) + "-" + (day);
        $("#Fecha_Venta").val(today);

        $("#Fecha_Constitucion").val(today);
        $("#Fecha_Nacimiento").val(today);
        $("#Fecha_Entrega").val(today);

    });


    function ProductoDetalle()
    {
        var IdProducto = $("#basic2 option:selected").val();

        var obj = {};

        obj['Id'] = IdProducto;

        var jsonObject = {
            "Producto": obj
        };

        // LIMPIA DATOS
        $("#SP_Nombre").text("");
        $("#SP_SKU").text("");
        $("#SP_Categoria").text("");
        $("#SP_Descripcion").text("");
        $("#SP_Distribuidor").text("");
        $("#SP_Publico").text("");
        $("#SP_Demo").text("");
        $("#SP_PromocionArticulo").text("");
        $("#DivImg").html("");

        $.ajax({
            type: "POST",
            url: "@Url.Action("Producto_Seleccionar_Id", "Productos")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: Resultado2,
            error: Errores2
        });
    }

    function Resultado2(data) {

        console.log(data);

        if (data.Producto.Id > 0) {

            $("#SP_Nombre").text(data.Producto.Nombre);
            $("#SP_SKU").text(data.Producto.SKU);
            $("#SP_Categoria").text(data.Producto.Categoria);
            $("#SP_Descripcion").text(data.Producto.Descripcion);
            $("#SP_Distribuidor").text(data.Producto.PrecioDistribuidor);
            $("#SP_Publico").text(data.Producto.PrecioPublico);
            $("#SP_Demo").text(data.Producto.PrecioDemo);

            if (data.Producto.Precio > 0) {
                $("#SP_PromocionArticulo").text(data.Producto.Precio);
            } else {
                $("#SP_PromocionArticulo").text("Ninguna");
            }

            $("#DivImg").html("<img src='http://"+ data.ProductoImg.Descripcion + "' class='d-block w-100' />");




        } else {
            $.notify({
                //icon: 'fa fa-paw',
                message: 'Producto no encontrado'
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }

    }

    function Errores2(data) {
       $.notify({
        title: 'Producto no buscado, intente mas tarde',
        },{
        type: 'danger',
            time: 1000,
        });
    }

    function ClienteDetalle() {

        var IdCliente = $("#basic option:selected").val();

        var obj = {};

        obj['Id'] = IdCliente;

        var jsonObject = {
            "Cliente": obj
        };

        // LIMPIA DATOS
        $("#SClienteNombre").text("");
        $("#SC_Nombre").text("");
        $("#SC_Persona").text("");
        $("#SC_TitleFecha").text("");
        $("#SC_Fecha").text("");
        $("#SC_RFC").text("");
        $("#SC_TitleSexo").text("");
        $("#SC_Sexo").text("");
        $("#SC_TipoCliente").text("");
        $("#SC_Origen").text("");
        $("#SC_Correo").text("");
        $("#SC_Movil").text("");
        $("#SC_Local").text("");

        // DIRECCION
        $("#SC_DireccionFisica").text("");
        $("#SC_DireccionEntrega").text("");

        //
        $("#Div_FromCliente1").css("display", "none");
        $("#Div_FromCliente2").css("display", "none");
        $("#Div_FromCliente3").css("display", "none");

        ///INFORMACION DE VISTA 3


        $.ajax({
            type: "POST",
            url: "@Url.Action("Cliente_Seleccionar_Id", "Clientes")",
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: Resultado,
            error: Errores
        });

    }

    function Resultado(data) {
        if (data.IdCliente > 0) {

            $("#Div_FromCliente1").show();
            $("#Div_FromCliente2").show();
            $("#Div_FromCliente3").show();

            $("#SClienteNombre").text(data.Nombre);
            $("#SC_Nombre").text(data.Nombre);
            if (data.TipoPersona == 1) {
                $("#SC_Persona").text("Física");
                $("#SC_TitleFecha").text("Fecha nacimiento:");
                $("#SC_Fecha").text(data.FechaNacimiento.substring(0, 10));
                $("#SC_RFC").text(data.RFC);
                $("#SC_TitleSexo").text("Sexo:");
                if (data.Sexo == 1) {
                    $("#SC_Sexo").text("Masculino");
                } else {
                    $("#SC_Sexo").text("Femenino");
                }

            } else {
                $("#SC_Persona").text("Moral");
                $("#SC_TitleFecha").text("Fecha constitución:");
                $("#SC_Fecha").text(data.FechaConstitucion.substring(0, 10));
                $("#SC_RFC").text(data.RFC);
            }
            $("#SC_TipoCliente").text(data.TipoCliente);
            $("#SC_Origen").text(data.OrigenCliente);
            $("#SC_Correo").text(data.Correo);
            $("#SC_Movil").text(data.TelefonoMovil);
            $("#SC_Local").text(data.TelefonoLocal);

            var direccion = "";
            direccion = "<br>" + data.Estado + ", " + data.Poblacion + ", <strong>Col: </strong>" + data.Colonia + ", <strong>CP: </strong>" + data.CP + ", <strong>Calle: </strong> " + data.Calle + ", <strong>NumEx: </strong> " + data.NumExterior;
            if (data.NumInterior.length > 0) {
                direccion += ",  <strong>NumInt: </strong> " + data.NumInterior;
            }
            if (data.EntreCalles.length > 0) {
                direccion += ",  <strong>Entre calles: </strong> " + data.EntreCalles;
            }
            if (data.Referencias.length > 0) {
                direccion += ",  <strong>Referencias: </strong> " + data.Referencias;
            }


            $("#SC_DireccionFisica").html(direccion);

            if (data.FiscalEntrega == 0) {
                var direccion = "";
                direccion = "<br>" + data.Estado2 + ", " + data.Poblacion2 + ", <strong>Col: </strong>" + data.Colonia2 + ", <strong>CP: </strong>" + data.CP2 + ", <strong>Calle: </strong> " + data.Calle2 + ", <strong>NumEx: </strong> " + data.NumExterior2;
                if (data.NumInterior2.length > 0) {
                    direccion += ",  <strong>NumInt: </strong> " + data.NumInterior2;
                }
                if (data.EntreCalles2.length > 0) {
                    direccion += ",  <strong>Entre calles: </strong> " + data.EntreCalles2;
                }
                if (data.Referencias2.length > 0) {
                    direccion += ",  <strong>Referencias: </strong> " + data.Referencias2;
                }
                $("#SC_DireccionEntrega").text(direccion);

            } else {
                $("#SC_DireccionEntrega").text("La dirección fiscal es la misma dirección de entrega");
            }


        } else {
            $.notify({
                //icon: 'fa fa-paw',
                message: 'Cliente no encontrado'
            }, {
                type: 'danger',
                allow_dismiss: false,
                animate: {
                    enter: 'animated rollIn',
                    exit: 'animated rollOut'
                }
            });
        }

    }

    function Errores(data) {
       $.notify({
        title: 'Cliente no buscado, intente mas tarde',
        },{
        type: 'danger',
            time: 1000,
        });
    }

</script>

<script type="text/javascript">
    function BusquedaRFC() {
        var resultado = false;

        var persona = $("#Select_Persona option:selected").val();
        var rfc = "";
        if (persona == 1) {
            rfc = $('#RFC').val();
        } else {
            rfc = $('#RFC_Moral').val();
        }

        // BUSCAR RFC
        var obj = {};
        obj['RFC'] =  rfc;

        var jsonObject = {
            "Cliente": obj
        };

        $.ajax({
            type: "POST",
            url: "@Url.Action("BuscarClienteRFC", "Clientes")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (respuesta) {
                if (respuesta.IdCliente > 0) {
                    $('#RFC').css("border", "2px solid #f44336");
                    $('#RFC_Mensaje').text("El RFC ya se encuentra registrado dentro del sistema.");

                    $.notify({
                        message: "El RFC ya se encuentra registrado dentro del sistema."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                    });
                } else {
                    $('#RFC').css("border", "2px solid #31CE36");
                    resultado = true;
                }
	        },
	        error: function() {
                $.notify({
                message: "RFC no buscado."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        });

        return resultado;
    }

    function ValidaRFC(input) {
        var persona = $("#Select_Persona option:selected").val();
        if (persona == 1) {
            if (validarInput(input)) {
                $('#RFC').css("border", "1px solid #c2c2c2");
                $('#RFC_Mensaje').text("");

                // BUSCAR RFC
                var obj = {};
                obj['RFC'] =  $('#RFC').val();

                var jsonObject = {
                    "Cliente": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("BuscarClienteRFC", "Clientes")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (respuesta) {
                        if (respuesta.IdCliente > 0) {
                            $('#RFC').css("border", "2px solid #f44336");
                            $('#RFC_Mensaje').text("El RFC ya se encuentra registrado dentro del sistema.");

                            $.notify({
                                message: "El RFC ya se encuentra registrado dentro del sistema."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                            });
                        } else {
                            $('#RFC').css("border", "2px solid #31CE36");
                        }
	                },
	                error: function() {
                        $.notify({
                        message: "RFC no buscado."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                        });
                    }
                });

            } else {
                $('#RFC').css("border", "2px solid #f44336");
                $('#RFC_Mensaje').text("RFC no valido.");

                $.notify({
                message: "RFC no valido."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        } else if (persona == 2) {
            if (validarInput(input)) {
                $('#RFC_Moral').css("border", "1px solid #c2c2c2");
                $('#RFC_MoralMensaje').text("");

                // BUSCAR RFC
                var obj = {};
                obj['RFC'] =  $('#RFC_Moral').val();

                var jsonObject = {
                    "Cliente": obj
                };

                $.ajax({
                    type: "POST",
                    url: "@Url.Action("BuscarClienteRFC", "Clientes")",
                    data: JSON.stringify(jsonObject),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (respuesta) {
                        if (respuesta.IdCliente > 0) {
                            $('#RFC_Moral').css("border", "2px solid #f44336");
                            $('#RFC_MoralMensaje').text("El RFC ya se encuentra registrado dentro del sistema.");

                            $.notify({
                                message: "El RFC ya se encuentra registrado dentro del sistema."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                            });
                        } else {
                            $('#RFC_Moral').css("border", "2px solid #31CE36");
                        }
	                },
	                error: function() {
                        $.notify({
                        message: "RFC no buscado."
                            }, {
                                type: 'danger',
                                allow_dismiss: false,
                                animate: {
                                    enter: 'animated rollIn',
                                    exit: 'animated rollOut'
                                }
                        });
                    }
                });

            } else {
                $('#RFC_Moral').css("border", "2px solid #f44336");
                $('#RFC_MoralMensaje').text("RFC no valido.");

                $.notify({
                message: "RFC no valido."
                    }, {
                        type: 'danger',
                        allow_dismiss: false,
                        animate: {
                            enter: 'animated rollIn',
                            exit: 'animated rollOut'
                        }
                });
            }
        }
    }



    ///// VALIDACION DE RFC

    //Función para validar un RFC
    // Devuelve el RFC sin espacios ni guiones si es correcto
    // Devuelve false si es inválido
    // (debe estar en mayúsculas, guiones y espacios intermedios opcionales)
    function rfcValido(rfc, aceptarGenerico = true) {
         _rfc_pattern_pm = "^(([A-ZÑ&]{3})([0-9]{2})([0][13578]|[1][02])(([0][1-9]|[12][\\d])|[3][01])([A-Z0-9]{3}))|" +
                  "(([A-ZÑ&]{3})([0-9]{2})([0][13456789]|[1][012])(([0][1-9]|[12][\\d])|[3][0])([A-Z0-9]{3}))|" +
                  "(([A-ZÑ&]{3})([02468][048]|[13579][26])[0][2]([0][1-9]|[12][\\d])([A-Z0-9]{3}))|" +
                  "(([A-ZÑ&]{3})([0-9]{2})[0][2]([0][1-9]|[1][0-9]|[2][0-8])([A-Z0-9]{3}))$";
     _rfc_pattern_pf = "^(([A-ZÑ&]{4})([0-9]{2})([0][13578]|[1][02])(([0][1-9]|[12][\\d])|[3][01])([A-Z0-9]{3}))|" +
                       "(([A-ZÑ&]{4})([0-9]{2})([0][13456789]|[1][012])(([0][1-9]|[12][\\d])|[3][0])([A-Z0-9]{3}))|" +
                       "(([A-ZÑ&]{4})([02468][048]|[13579][26])[0][2]([0][1-9]|[12][\\d])([A-Z0-9]{3}))|" +
                       "(([A-ZÑ&]{4})([0-9]{2})[0][2]([0][1-9]|[1][0-9]|[2][0-8])([A-Z0-9]{3}))$";
       return rfc.match(_rfc_pattern_pm) || rfc.match(_rfc_pattern_pf);
    }


    //Handler para el evento cuando cambia el input
    // -Lleva la RFC a mayúsculas para validarlo
    // -Elimina los espacios que pueda tener antes o después
    function validarInput(input) {
        var respuesta = false;

        var rfc         = input.value.trim().toUpperCase(),
            resultado   = document.getElementById("resultado"),
            valido;

        var rfcCorrecto = rfcValido(rfc);   //

        if (rfcCorrecto) {
            var respuesta = true;
        }
        return respuesta;
    }

     function Verificar2() {

        var selectedValue = $("#basic").val(); // Obtener el valor seleccionado


        var obj = {};
        obj['Id'] = selectedValue;

        var jsonObject = {
            "data": obj
        };

         console.log(obj);

        $.ajax({
            type: "POST",
            url: "@Url.Action("verificar", "Ventas")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.IdCliente == 2) {
                    $(".precio-selector").val(1).change();
                } else {
                    $(".precio-selector").val(2).change();
                }
            },
            error: function (data) {

            }
        });
     }

</script>
